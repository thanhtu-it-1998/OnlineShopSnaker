typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.registerInterface("Common.App.Enrichment.k");Common.App.Enrichment.n=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.n.prototype={requestId:null,cellId:null};Common.App.Enrichment.h=function(){this.messageType=type};Common.App.Enrichment.h.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.h;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.j=function(){};Common.App.Enrichment.j.prototype={Query:null,TelemetryJson:null};Common.App.Enrichment.i=function(n){this.messageType=n};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.R);this.r=Function.createDelegate(this,this.O);this.p=Function.createDelegate(this,this.M);this.q=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.P);this.o=Function.createDelegate(this,this.L);this.h=n;this.k=t;this.z=i;this.j=r;this.u=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.h()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={h:null,k:null,e:null,d:null,z:null,j:null,u:null,v:null,w:null,l:null,g:null,i:null,x:!1,C:function(){return!0},m:function(){return Common.a.a.b("EnrichmentPaneUrl")},dispose:function(){this.C()&&this.g&&(this.h.b("click",this.g,this.o),this.k.b("keyup",this.g,this.s));this.g=null;this.d&&(this.T(),this.d.parentNode.removeChild(this.d),this.d=null);var n=this.j.a("EnrichmentPaneId");n.b(this.i)},b:function(n,t,i){this.e=n;this.x||(this.l=this.F(),this.B().appendChild(this.l),this.Q(),this.u.a(1520278933,2147483648,this.y),this.S(),this.x=!0);this.d.src=this.m()&&this.m().length?this.m()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.v=t;this.w=i;this.E()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.n(i)},S:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.h.d("EnrichmentPaneId",this.l,!1);n.c(this.i,1520278933)},R:function(){if(this.d){Common.n.b(this.d.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.n(n)}},L:function(){return this.A(),!0},P:function(n){var t=n.a.keyCode;return t===13||t===32?(this.A(),!0):!1},A:function(){this.a();this.e&&this.e.a()},F:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.C()&&n.appendChild(this.G()),this.K(n),n},G:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.bh,i.title=$a.bh,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.c,"ClosePaneGlyph_16x16x32",!1),this.h.a("click",n,this.o),this.k.a("keyup",n,this.s),t.appendChild(i),t.appendChild(n),this.g=n,t},K:function(n){this.d=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.d);this.d.id="EnrichmentContentFrame"},Q:function(){Common.j.a(this.d,"load",this.q);Common.j.a(this.d,"error",this.p);$addHandler(window,"message",this.r)},T:function(){Common.j.c(this.d,"load",this.q);Common.j.c(this.d,"error",this.p);$removeHandler(window,"message",this.r)},H:function(){this.d.src="about:blank"},a:function(){this.D();this.H()},J:function(n,t,i){return i!==1&&(this.a(),this.e&&this.e.a()),32},N:function(){},M:function(){},O:function(n){var r=n.rawEvent,t,u,f,e,o,i,s,h,c,l,a,v;if(!this.d||this.d.src.indexOf(r.origin)!==-1){try{t=JSON.parse(r.data)}catch(b){return}if(!CommandUI.a.a(t.messageType)){u=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.n(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.v),this.w));break;case 1:this.n(new(Common.App.Enrichment.c.$$(String))(0,this.I()));break;case 3:f=t;this.e&&this.e.i(f.messageContent);break;case 5:e=t;this.e&&this.e.f(e.messageContent);break;case 8:o=t;this.e&&(i=JSON.parse(o.messageContent),this.e.g(i.Query,i.TelemetryJson));break;case 6:this.e&&this.e.c();break;case 11:var y=t,p=JSON.parse(y.messageContent),w=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,p,!0,!1,!1);this.d&&this.d.dispatchEvent(w);break;case 12:s=t;h=JSON.parse(s.messageContent);h.keyCode===27&&(c=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.d&&(this.d.dispatchEvent(c),this.a(),this.e&&this.e.a()));break;case 13:l=t;this.e&&this.e.h(l.messageContent);break;case 14:a=t;this.e&&this.e.j(a.messageContent);break;case 15:v=t;this.e&&this.e.k(v.messageContent)}window.g_badCastCallback=u}}},I:function(){return JSON.stringify([2,1,3,5,8,6])},n:function(n){var t=JSON.stringify(n);this.d.contentWindow.postMessage(t,Common.k.g(this.m()))}};Common.App.Enrichment.g=function(n){this.m=n};Common.App.Enrichment.g.prototype={m:null,l:null,e:function(n,t,i){this.l=n;this.m&&this.m.b(this,t,i)},b:function(n,t){this.m&&this.m.c(n,t)},d:function(){this.m&&this.m.a()},dispose:function(){this.m&&(this.m.dispose(),this.m=null)},i:function(n){return this.l?this.l.t(n):!1},g:function(n,t){this.l&&this.l.r(n,t)},f:function(n){return this.l?this.l.p(n):!1},a:function(){this.l&&this.l.q()},c:function(){this.l&&this.l.o()},h:function(n){this.l&&this.l.s(n)},j:function(n){this.l&&this.l.u(n)},k:function(n){this.l&&this.l.v(n)}};Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h");Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.l,Sys.IDisposable);Common.App.Enrichment.g.registerClass("Common.App.Enrichment.g",null,Common.App.Enrichment.k,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bbG=function(){};_Ewa.FU=function(n,t){this.b=t;this.a=n};_Ewa.FU.prototype={b:null,a:null,z:function(n,t){switch(t){case-1203788282:case 48568533:case-1662108744:var i=_Ewa.b.a(this.b),r=this.a.B()||7e3;return i&&i.a()&&i.a().a().b().G()>r?!0:!1;default:return!1}},x:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u=t.a;switch(u){case-1203788282:this.a.z(i.MenuItemId.toString());break;case 311599363:this.a.x();break;case 439914789:this.a.l();break;case 2127195269:this.a.G();break;case-1662108744:this.a.H(i.MenuItemId.toString());break;case 1266950951:this.a.F(!0);break;case 49813714:this.a.A();break;default:r=_Ewa.T.a(u)}return r},w:function(n,t){switch(t.a){case-1203788282:case 439914789:case 2127195269:case 49813714:return this.b.a(157);case-1662108744:return this.b.a(761);case 311599363:case 1266950951:return!0;default:return!1}},y:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&this.b.a(157)?this.a.J(n,t,i):!1}};_Ewa.ut=function(n){_Ewa.ut.initializeBase(this,[n])};_Ewa.ut.a=function(n){_Ewa.bc.a(273,new _Ewa.ut(n))};_Ewa.ut.prototype={g:function(){var n=this;_Ewa.fS.a(_Ewa.eq,this.a,271,272,this.c,function(t){n.f([new _Ewa.FU(t,n.a)],null)},null)}};_Ewa.FY=function(n){this.campaignId=n;this.commentQuestion=_Ewa.ClientStringManager.a().c(135);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=_Ewa.ClientStringManager.a().c(131);this.ratingValuesAscending=[_Ewa.ClientStringManager.a().c(132),_Ewa.ClientStringManager.a().c(133),_Ewa.ClientStringManager.a().c(134)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=_Ewa.ClientStringManager.a().c(130)};_Ewa.FY.prototype={commentQuestion:null,campaignId:null,isZeroBased:!1,aditionalDataRequested:null,ratingQuestion:null,ratingValuesAscending:null,showEmailRequest:!1,showPrompt:!1,surveyType:0,title:null};_Ewa.FV=function(n,t,i,r,u){this.w=Function.createDelegate(this,this.I);this.k=Function.createDelegate(this,this.R);this.m=Function.createDelegate(this,this.K);this.x=Function.createDelegate(this,this.J);this.y=Function.createDelegate(this,this.M);this.o=Function.createDelegate(this,this.O);this.z=Function.createDelegate(this,this.Q);this.n=Function.createDelegate(this,this.L);this.j=Function.createDelegate(this,this.P);this.a=n;this.b=_Ewa.b.a(this.a);this.a.a(922)?this.b.a().q(this.j):this.b.a().k(this.j);this.b.w(this.n);this.l=r;this.p=u;i.f(_Ewa.qs,t);var f=new _Ewa.FW(t);this.g=new _Ewa.FX(f)};_Ewa.FV.prototype={a:null,q:!1,c:!1,e:!0,i:!1,r:!1,f:null,h:0,l:null,b:null,g:null,p:null,dispose:function(){this.a&&(this.a.a(922)?this.b.a().t(this.j):this.b.a().i(this.j),this.b.y(this.n))},U:function(n){var i=_Ewa.g.c(this.b.a().a().a(),this.a),t=this,r=function(r,u){return _Ewa.eN.m(t.a.d().a(),i,n,_Ewa.n.a(r,t.z),u,null,null)},f=this,u=function(){return new _Ewa.el},e=this;return _Ewa.P.a(this.a.g(),r,function(n){return new _Ewa.H(109,0,n,0,u)},null),!0},S:function(n,t){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var r=_Ewa.g.c(this.b.a().a().a(),this.a),i=this,u=function(t,u){return _Ewa.eN.l(i.a.d().a(),r,n,_Ewa.n.a(t,i.o),u,null,null)},f=this;_Ewa.P.a(this.a.g(),u,function(n){return new _Ewa.H(110,0,n,16,null)},null);return},H:function(n){var t=_Ewa.g.c(this.b.a().a().a(),this.a);!t;this.e=!1;var i=this,r=function(r,u){return _Ewa.eN.i(i.a.d().a(),t,n,_Ewa.n.a(r,i.y),u,null,null)},u=this;return _Ewa.P.a(this.a.g(),r,function(n){return new _Ewa.H(111,0,n,16,null)},null),!0},N:function(){this.c=!1;this.q=!0;this.h=0;return},B:function(){var n=this.v();if(n){var t=this,i=function(i,r){return _Ewa.eN.b(t.a.d().a(),n,_Ewa.n.a(i,t.o),r,null,null)},r=this;_Ewa.P.a(this.a.g(),i,function(n){return new _Ewa.H(112,0,n,16,null)},null);return}},T:function(n){var t,i;if(Diag.a.a(591005634,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane"),this.d(),!n||!n.length){Diag.a.a(593282251,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane");return}if(t=JSON.parse(n),!t){Diag.a.a(593282250,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");return}if(!(t.domainId!=null)){Diag.a.a(593282249,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");return}i={};i.Id=t.domainId;i.StringId=t.stringId;this.p.y(i)},V:function(n){var t=new _Ewa.O(-859308420,_Ewa.G.a,this.a.t(),9,"Help"),i={CommandValueId:"HelpID="+n,InputMethod:_Ewa.G.a,ShouldCanvasTakeFocus:!0,MenuItemId:"HelpArticle"};this.a.h().a(t,i,null)},W:function(n){Fdbk.a.J(new _Ewa.FY(n))},L:function(){(this.e||this.c)&&(this.a.a(761)&&this.h===2||this.s(!1))},R:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},s:function(n){this.G(n)},E:function(){var n,t;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.v(),n){t=null;this.a.a(761)&&(t=1);var i=this,r=function(r,u){return _Ewa.eN.a(i.a.d().a(),n,!0,_Ewa.n.a(r,i.x),u,t,null)},u=this;_Ewa.P.a(this.a.g(),r,function(n){return new _Ewa.H(113,0,n,16,null)},null)}},F:function(n,t){var i=null;this.a.a(761)&&(i=2);var r=this,u=function(u,f){return _Ewa.eN.e(r.a.d().a(),n,t,_Ewa.n.a(u,r.m),f,i,null)},f=this;_Ewa.P.a(this.a.g(),u,function(n){return new _Ewa.H(233,0,n,16,null)},null)},I:function(n){var t,i,u,r;if(_Ewa.h.d(n.Errors)){t=_Ewa.h.a(n.Errors,",");_Ewa.e.c(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(!n.WorkbookMetadataResult.Metadata&&this.r&&(i=_Ewa.l.b(_Ewa.cP,this.a.b(),5,4,0,null),u=this,_Ewa.f.cw(i,function(){i.a().i()},this.a.i(),3)),this.a.c().i(this.k),this.a.c().g(this.k),r=n.Result,this.f=r.SkydanceFeatureBitmask,this.u(r),this.i=!0)},P:function(){(this.e||this.c)&&this.s(!1)},K:function(n,t){var i,r;if(_Ewa.h.d(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.i=!1;this.A(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005633,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.t(r)}return},J:function(n,t){var i,r;if(_Ewa.h.d(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.A(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005632,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.t(r)}return},A:function(n){if(n&&this.a.a(761)){var t=n;t&&t!==this.h&&!this.a.a(940)&&(Diag.a.a(591005603,0,50,"ConvertToLinkedEntityDisambiguationPane:SetPaneViewType: Calling CloseDisambiguationPane"),this.d());this.h=t}},t:function(n){var t,i;this.c?this.g.b(n,null):(t=3,this.f!=null?t=this.f:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set"),i=this.D(n,t),i||Diag.a.a(577528395,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.l||Diag.a.a(577528394,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.g.e(this.l,i,null),this.c=!0);return},d:function(){this.c&&(Diag.a.a(591005602,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.g.d(),this.c=!1,this.h=0);return},M:function(n){if(_Ewa.h.d(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.h.a(n.Errors,","));this.e=!0;return}if(n.Result){var t=n.Result;this.f=t.SkydanceFeatureBitmask;this.u(t);this.i=!0}return},u:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){Diag.a.a(591005601,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane");this.d();this.a.c().i(this.k);return}r=new _Ewa.p(t,i,t,i,!0,!1);this.b.a().d(r,r,60,0,!0,"",!1,!0,!0);this.e=!0;Diag.a.a(591005600,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling LaunchOrUpdateDisambiguationPane");this.a.a(922)||this.t(u)},D:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.o,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.l,i.appCorrelationId=Common.y.a().a,r=Common.e.b(Common.a.p),u=r?r.a:null,i.uiLanguage=u,i.market=this.C(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},C:function(n){var t=n.split("-");return t[t.length-1]},G:function(n){var t=this.b.a().a().a(),r,i;if(!this.v()||!t){this.d();return}if(_Ewa.b.a(this.a).e().e(t)){if(this.q&&!n&&!this.i)return;n&&(this.e=!0);r=_Ewa.g.c(t,this.a);i=null;this.a.a(761)&&(i=1);var u=this,f=function(n,t){return _Ewa.eN.a(u.a.d().a(),r,!1,_Ewa.n.a(n,u.m),t,i,null)},e=this;_Ewa.P.a(this.a.g(),f,function(n){return new _Ewa.H(114,0,n,16,null)},null)}else this.a.a(1062),this.d();return},Q:function(n){if(_Ewa.h.d(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.h.a(n.Errors,",")),n.Result){var t=n.Result;this.u(t);this.i=!0}else this.d();return},O:function(n){if(_Ewa.h.d(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.h.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.g.b(t,null)}else Diag.a.a(591005598,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.d();return},v:function(){var n=this.b.a().a();return n.k()?_Ewa.g.c(n.a(),this.a):null}};_Ewa.fr=function(n,t,i,r){this.bZ=Function.createDelegate(this,this.cJ);this.ca=Function.createDelegate(this,this.cK);this.bV=Function.createDelegate(this,this.cA);this.bW=Function.createDelegate(this,this.cB);this.bt=Function.createDelegate(this,this.cs);this.bY=Function.createDelegate(this,this.cH);this.bG=Function.createDelegate(this,this.cF);this.bH=Function.createDelegate(this,this.cG);this.cb=Function.createDelegate(this,this.cM);this.bX=Function.createDelegate(this,this.cE);this.bF=Function.createDelegate(this,this.cC);this.bu=Function.createDelegate(this,this.cD);this.bK=Function.createDelegate(this,this.cN);this.bI=Function.createDelegate(this,this.cI);this.bJ=Function.createDelegate(this,this.cL);this.T=new Array(12);_Ewa.fr.initializeBase(this,[!1]);this.P=n;this.V=[];this.S=_Ewa.b.a(this.P);this.bm=-1;this.bj=this.P.a(159);this.Z=this.P.a(635);this.bs=this.P.a(864);this.bO=this.P.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.bR=this.P.a(160);this.bh=this.P.a(633)&&this.P.a(370);this.bk=this.P.a(544);this.bD=this.P.isChangeGateEnabled("OfficeVSO:4580192_StartHandshakeOnSessionIdChanged");this.R=new($$sc.v.$$(_Ewa.Cb));this.bP=this.P.m()+"Ribbon.Data.LinkedEntity";this.ba=new _Ewa.pC(t,this);i&&(this.Q=new _Ewa.FV(n,i,r,this,this));this.bj?(this.bD?this.P.c().g(this.bJ):this.P.c().G(this.bI),_Ewa.ch.a(this.P)&&_Ewa.ch.a(this.P).u(this),this.bM(!1)):n.b().b(_Ewa.eq,271,this);(this.bk||this.bh)&&this.P.c().q(this.bK);this.P.a(157)&&this.P.a(172)&&(this.cp()||this.S.w(this.bu));this.Z&&this.P.Q(this.bF)};_Ewa.fr.b=function(n,t,i,r,u){var f=u?'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel-70" align="middle">{0}<\/p><\/div>':'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',e=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,t,r),o=String.format(f,i);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',e,o)};_Ewa.fr.a=function(n){return n.StringId?n.Id.toString()+"."+n.StringId:n.Id.toString()};_Ewa.fr.prototype={P:null,ba:null,bl:!1,bp:!1,bO:!1,bR:!1,bk:!1,bh:!1,bA:null,bj:!1,bD:!1,bg:null,bn:null,bC:null,bB:null,bz:0,bo:0,Z:!1,bs:!1,bi:null,V:null,Q:null,by:null,bf:null,U:0,S:null,be:null,bw:null,bm:0,W:8,bP:null,bc:null,bd:null,cu:function(){return _Ewa.e.a(this.bw)&&(this.bw=_Ewa.ClientStringManager.a().a(1558)),this.bw},R:null,bb:null,bv:0,cc:5,bq:3e4,bS:!1,X:null,br:null,dispose:function(){(this.bk||this.bh)&&this.P.c().t(this.bK);!this.X&&this.P.a(157)&&this.P.a(172)&&this.S.y(this.bu);this.Q&&this.Q.dispose();this.Z&&this.P.S(this.bF);this.bj&&(this.bD?this.P.c().i(this.bJ):this.P.c().K(this.bI),this.bh&&(this.bA=null));System.a.a(this.bb)},w:function(n){this.dQ("LinkedEntityConverted",n)},t:function(n){return this.Q?this.Q.U(n):!1},r:function(n,t){this.Q&&this.Q.S(n,t)},p:function(n){return this.Q?this.Q.H(n):!1},q:function(){this.Q&&this.Q.N()},o:function(){this.Q&&this.Q.B()},s:function(n){this.Q&&this.Q.T(n)},u:function(n){this.Q&&this.Q.V(n)},v:function(n){this.Q&&this.Q.W(n)},cN:function(){this.bk&&this.cR();this.bh&&this.bT(!0)},bT:function(n){if(this.bh&&this.bA==null&&((this.bg==null)?this.bg&&!(this.bn==null)?!0:!this.bn:!0)&&(!n||this.P.l().Options&262144)){var t=_Ewa.l.b(_Ewa.jq,this.P.b(),274,275,0,null),i=this;_Ewa.f.cw(t,function(){i.bA=t.a().a(1)},this.P.i(),3)}},c:function(){return this.T.length},bL:null,B:function(){return this.bL},z:function(n){var t=this.ct(n);if(!t){Diag.a.a(593241931,0,10,"Could not convert key into domain ID");return}this.y(t)},y:function(n){var h,r,u,t,f,e,i;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n.Id),!this.S){Diag.a.b(34415005,0,!1,"grid view should not be null");return}this.cP(n);var o=this.S.a().a().b(),c=this.S.U(),s=o.l(c);if(s){if(h=this.S.e().A(s),h){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.C.a().j()){if(r=this.ch(),!r){Diag.a.a(588001756,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(u=this.cd(),!u){Diag.a.a(588001755,0,50,"RibbonCommandInfo is null for blankCellConvert");return}t={InputMethod:_Ewa.G.a};t.CalloutType=1;t.Target=r;t.RibbonButtonLabel=this.cn(n);t.ExampleEntities=this.cg(n);t.BlankCellResourceId=this.cr(n);t.HasBlankCellWalkthrough=this.cw(n);this.P.h().a(u,t,null);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}else if(!this.cx(n)&&n.Id===268435968&&this.P.a(634)){if(Diag.a.a(588001754,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data"),_Ewa.C.a().j()){if(f=this.ch(),!f){Diag.a.a(588001753,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(e=this.cd(),!e){Diag.a.a(588001752,0,50,"RibbonCommandInfo is null for blankCellConvert");return}i={InputMethod:_Ewa.G.a};i.CalloutType=3;i.Target=f;i.RibbonButtonLabel=this.P.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.cn(n):this.j(n.Id.toString());i.ExampleEntities=this.cg(n);this.P.h().a(e,i,null);return}Diag.a.a(588001751,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.bR&&n.Id===268435968&&!n.StringId){this.H(_Ewa.fr.a(n));return}this.g(n,!1,o)}},A:function(){this.X&&this.X.w()},I:function(){var n=this,t=function(t,i){return _Ewa.eN.j(n.P.d().a(),t,i,null,null)},i=this;_Ewa.P.a(this.P.g(),t,function(n){return new _Ewa.bg(230,0,n,16,null)},null)},g:function(n,t,i){var u=_Ewa.g.e(i,this.P),r=this,f=function(i,f){return _Ewa.eN.d(r.P.d().a(),u,n,t,_Ewa.n.a(i,r.bX,r.cb,r.Q.w),f,null,null)},o=this,e=function(){return new _Ewa.el},s=this;_Ewa.P.a(this.P.g(),f,function(n){return new _Ewa.H(115,0,n,0,e)},null)},cE:function(n){if(!_Ewa.h.d(n.Errors)&&(this.bT(!1),this.P.isChangeGateEnabled("OfficeVSO:4499819_FireEventToShowPulloutOOUIOnConvert"))){var t=_Ewa.l.b(_Ewa.io,this.P.b(),261,262,0,null),i=this;_Ewa.f.cw(t,function(){i.dP("LinkedEntityConverted",null,null)},this.P.i(),3)}},cM:function(){var n=this;this.P.b().c(_Ewa.cA,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1575))},null)},x:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),!this.S){Diag.a.b(34719502,0,!1,"grid view should not be null");return}var n=_Ewa.g.e(this.S.a().a().b(),this.P),t=this,i=function(i,r){return _Ewa.eN.c(t.P.d().a(),n,i,r,null,null)},r=this;_Ewa.P.a(this.P.g(),i,function(n){return new _Ewa.H(116,0,n,0,null)},null)},l:function(){var n;if(Diag.a.a(36234048,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities() - refresh attempted"),n=_Ewa.b.a(this.P),!n){Diag.a.b(36234049,0,!1,"grid view should not be null");return}this.P.k()||Diag.a.a(591528644,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities(): Refreshing selection during view mode");var t=_Ewa.g.c(n.a().a().a(),this.P),i=this,r=function(n,r){return _Ewa.eN.k(i.P.d().a(),t,n,r,null,null)},u=this;_Ewa.P.a(this.P.g(),r,function(n){return new _Ewa.H(117,0,n,0,null)},null)},N:function(){return this.co(this.bc)},M:function(){return this.co(this.bd)},co:function(n){try{if(this.U===2&&n){if(!this.bs)return!this.bx(parseInt(n));var t=this.bx(parseInt(n));return!t||!t.ShowInRibbon}}catch(i){Diag.a.a(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+n)}return!0},m:function(n){var t=this.a(n.DomainId),i,r;if(!t||t.DomainBlocked||this.P.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!t.HasCuratedData)return!1;if(this.bO){for(i=this.R.$$ge();i.$$mn();)if(r=i.$$cu(),r.a.DomainId.Id===t.DomainId.Id&&r.a.ShowInRibbon)return!0;return!1}return t.ShowInRibbon},K:function(n){return this.U!==2||!this.T[n]},L:function(){var n,t,i;if(this.Z)return Diag.a.a(592213150,0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.R)return!0;if(this.br!=null)return this.br;for(n=0,t=this.R.$$ge();t.$$mn();)i=t.$$cu(),i.a.DomainBlocked||++n;return this.br=n<=2,this.br},G:function(){this.Q&&this.Q.E()},J:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.by=i.MenuId,!this.U||this.U===3)return this.cO(),!0;if(this.Z)if(this.bi){if(this.R)return _Ewa.o.a()?(this.be=this.be||this.ba.d(this.bi,i.MenuId,this.P.a(761)),i.MenuItems=this.be,!0):(this.bf=this.bf||this.ba.b(this.bi,i.MenuId,this.P.a(761)),i.PopulationXML=this.bf,!0);Diag.a.a(593264904,0,10,"PopulateMenu: Encountered null domain collection")}else Diag.a.a(593264905,0,10,"PopulateMenu: Encountered null ribbon section info");return _Ewa.o.a()?(this.be=this.be||this.ba.c(this.V,i.MenuId,this.bs),i.MenuItems=this.be):(this.bf=this.bf||this.ba.a(this.V,i.MenuId,this.bs),i.PopulationXML=this.bf),!0},cO:function(){if(this.bm===-1){this.k();var n=this;this.bm=window.setInterval(function(){n.k()},2e3)}},k:function(){if(this.P.c().a()&&this.U!==2){this.W--;Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.U=1;this.Z?_Ewa.eN.f(this.P.d().a(),this.bH,this.bG,null,null):_Ewa.eN.g(this.P.d().a(),this.bH,this.bG,null,null);return}},cz:function(){return this.P.k()&&this.U!==2&&this.W>=0},cq:function(n){if(this.P.isChangeGateEnabled("OfficeVSO:4441793_LinkedEntityRibbonRefactoring2")){if(Common.a.g){Diag.a.a(587530655,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down.");return}if(!_Ewa.ch.a(this.P)){Diag.a.a(587530654,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.");return}this.bU()}else _Ewa.ch.a(this.P).i();n&&this.P.x()},cm:function(){this.bo=0;this.W=8;this.bm=0;this.U=0;this.bi=null;this.V=null;this.bN();for(var n=0;n<this.T.length;++n)this.T[n]=null;_Ewa.o.f(this.P)&&this.ck()&&this.cq(!0)},cI:function(){this.P.k()?this.bM(!1):this.cm()},cL:function(n,t){if(t.a){var i=_Ewa.v.b(_Ewa.R.a(this.P).a().a(),"OWMem",!1);i?this.bM(!0):this.cm()}},bN:function(){this.be=null;this.bf=null},ck:function(){var t=_Ewa.o.a()?"Data":this.P.m()+"Ribbon.Data",n=_Ewa.ch.a(this.P);return!!n&&n.a().a()===t},cG:function(n){var s,u,h,i,r,f,c,l,t,o;if(this.bN(),n.Result){if(this.Z?(r=n.Result,i=r.DomainDataArray,this.bi=r.Ribbon,r.MaximumCellsToConvert>0&&(this.bL=r.MaximumCellsToConvert)):i=n.Result,this.U=2,f=!1,i){Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",i.length);this.V||(this.V=[]);c=_Ewa.ClientStringManager.a().a(1558);l=_Ewa.ClientStringManager.a().a(1560);for(var a=i,v=a.length,e=0;e<v;++e){if(t=a[e],!t.DomainId){Diag.a.a(593291469,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.");continue}if(this.V.push(t),t.DomainBlocked){o=!!t.DomainId.StringId;Diag.a.a(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",o?t.DomainId.Id.toString():t.Name,o);continue}this.R.b(_Ewa.fr.a(t.DomainId),t);t.Name===c||t.DomainId.Id===268435456?this.bc=t.DomainId.Id.toString():(t.Name===l||t.DomainId.Id===536870912)&&(this.bd=t.DomainId.Id.toString());f=!0}}f||(this.V=null);this.cS()}else this.V=null,this.U=3,s=this.bj?-1:0,this.W>s&&(u=0,this.bj&&(u=100*(8-this.W)),h=this,window.setTimeout(function(){h.k()},u)),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.bQ();this.bS||(this.cQ(),this.bS=!0);this.bh&&this.bT(!0)},cF:function(n){var t=_Ewa.W.a(n.b);Diag.a.a(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",_Ewa.h.a(t,","));this.V=null;this.U=3;this.bj&&(this.W=-1);this.bQ()},cS:function(){var n,e,u,t;if(this.bi){n=0;for(var f=this.bi.Categories,s=f.length,i=0;i<s;++i){e=f[i];for(var o=e.DomainIds,h=o.length,r=0;r<h;++r)if(u=o[r],t=this.a(u),t&&!t.DomainBlocked&&t.ShowInRibbon&&(this.T[n]=u,++n,n>=this.T.length))break;if(n>=this.T.length)break}while(n<this.T.length)this.T[n]=null,++n}},cD:function(){this.cp()&&this.S.y(this.bu)},cP:function(n){if(this.Q){var t=this.a(n).Name===this.cu();this.Q.r=t}},cp:function(){var n=$$as(_Ewa.hQ,_Ewa.b.a(this.P).b()),i=!!n&&n.I(),r=this.S.a().c(),t;return i&&r===1&&this.S.a().a().a()?(t=_Ewa.l.a(_Ewa.cZ,this.P.b(),12,this.P.i(),1,null),this.X=new _Ewa.ti(this.P,t.a(),this),!0):!1},F:function(n){this.Q&&this.Q.s(n)},H:function(n){var t,i;if(this.Q){if(t=this.ce(n),!t){Diag.a.a(593097799,0,10,"Unknown domain used when launching Data Type Selector pane");return}if(t.DomainId.StringId){Diag.a.a(593097798,0,10,"Domain with a string ID used when launching Data Type Selector pane");return}i=_Ewa.g.d(this.S.a().a().c(),this.P);this.Q.F(i,t.DomainId.Id)}},e:function(){return this.f(this.bc)},d:function(){return this.f(this.bd)},f:function(n){var t=this.cy(n),i=Common.d.b(this.j(n)),r=Common.d.b(this.n(n));return _Ewa.fr.b(t,_Ewa.t.a(11),i,r,!1)},n:function(n){try{return this.bx(parseInt(n)).Description}catch(t){}return _Ewa.ClientStringManager.a().a(1555)},j:function(n){try{return this.bx(parseInt(n)).Name}catch(t){}return _Ewa.ClientStringManager.a().a(1546)},cn:function(n){try{return this.a(n).Name}catch(t){}return this.j(n.Id.toString())},cr:function(n){try{return this.a(n).BlankCellResourceId}catch(t){}return null},cw:function(n){try{return this.a(n).HasBlankCellWalkthrough}catch(t){}return!1},cx:function(n){try{return this.a(n).HasCuratedData}catch(t){}return!0},ch:function(){var n;return _Ewa.o.a()?n=_Ewa.ch.a(this.P).l()===2?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]":(n=document.getElementById(this.bP),n||Diag.a.b(588001750,0,!1,"Could not get multi-line ribbon anchor DOM element for the linked entity teaching callout.")),n},cd:function(){return new _Ewa.O(-847286761,_Ewa.G.a,this.P.t(),0,"Help")},D:function(n){return n===this.bc?"ewadata_StockLinkedEntity16":n===this.bd?"ewadata_GeographyLinkedEntity16":"ewadata_ConvertToEntityIcon16"},E:function(n){return this.X?this.X.A(n,!1):!1},C:function(){return this.X?this.X.C():""},i:function(n,t){var u=this.ci(n),r,i;if(u<0){Diag.a.a(592843911,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",n);return}(r=this.cf(n),i=r?this.a(r):null,i)&&(_Ewa.o.a()?t[CommandUI.Controls.a.GalleryButtonProps]=this.ba.f(u,i):t[CommandUI.Controls.a.InnerHTML]=this.ba.e(i),t.Alt=this.ba.g(i))},cy:function(n){return n===this.bc?"ewadata_StockLinkedEntity32":n===this.bd?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},cg:function(n){try{return this.a(n).ExampleEntities}catch(t){}return _Ewa.ClientStringManager.a().a(1562)},bQ:function(){this.W<0&&Diag.a.a(37089859,0,10,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(this.U===2||this.W<0)&&window.clearInterval(this.bm);_Ewa.o.f(this.P)&&!this.cz()?this.cq(this.ck()):this.by&&this.P.s().u(this.by)},Y:function(n){return this.P.m()+n},bU:function(){var h="Data.LinkedEntity.Stock-Large",c="Data.LinkedEntity.Geography-Large",e="Ribbon.Data.LinkedEntity",l="ConvertToLinkedEntityGallery",n=_Ewa.o.a(),t,r,s,f;if(this.Z){n||(_Ewa.i.e(this.Y(h)),_Ewa.i.e(this.Y(c)));var u=!0,i=new Array(this.T.length),o=_Ewa.ch.a(this.P)?_Ewa.ch.a(this.P).a():null;if(n&&!o){Diag.a.a(587530653,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null");return}for(t=0;t<i.length;++t)this.K(t)?i[t]=!0:(i[t]=!1,u=!1);if(n?o.c([l],u):u?_Ewa.i.e(this.Y(e)):_Ewa.i.D(this.Y(e),""),!u)for(r=0;r<i.length;++r)i[r]&&(s=this.h(r,n),n?o.c([s],!0):_Ewa.i.e(s))}else{var a=this.N(),v=this.M(),y=a&&v;if(!n||this.bl||this.bp||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(l,y?!0:!1)),y){n||_Ewa.i.e(this.Y(e));this.bp=!0;this.bl=!0;return}if(a?(n?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",!0)):_Ewa.i.e(this.Y(h)),this.bp=!0):v&&(n?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)):_Ewa.i.e(this.Y(c)),this.bl=!0),!n)for(f=0;f<this.T.length;++f)_Ewa.i.e(this.Y("Data.LinkedEntityPreview."+f.toString()+"-Large"));this.L()&&_Ewa.i.e(n?"ConvertToLinkedEntityGallery-previewExpandButton":this.Y("Data.LinkedEntity.Flyout-Thin"))}},a:function(n){var t=_Ewa.fr.a(n);return this.R.c(t)?this.R.a(t):(Diag.a.a(592729218,0,10,"No domain data for domain ID {0} (Has String ID: {1})",n.Id,!!n.StringId),null)},h:function(n,t){var i,r;return t?(i="ConvertToLinkedEntityPreview",i+n.toString()):(r="Data.LinkedEntityPreview.",this.P.m()+r+n.toString()+"-Large")},O:function(){if(!_Ewa.o.f(this.P)&&_Ewa.o.a()){var n=this;Common.App.AppLifecycleManager.get_instance().a(10,function(){n.bU()},3)}},b:function(n,t){var f;switch(n){case"QueryLinkedEntityGalleryButtons":if(!t.val[CommandUI.Controls.a.InnerHTML]){_Ewa.o.f(this.P)&&_Ewa.o.a()||this.bU();var i=t.val.MenuItemId.toString(),r=_Ewa.e.b(i,_Ewa.ClientStringManager.a().a(1558),!0)||_Ewa.e.b(i,_Ewa.ClientStringManager.a().a(1559),!0),u=_Ewa.e.b(i,_Ewa.ClientStringManager.a().a(1560),!0);this.P.a(635)?r||u||this.i(i,t.val):!this.bp&&r?(this.bp=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.e()):!this.bl&&u&&(this.bl=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.d())}break;case"QueryLinkedEntityMenuGalleryButtons":t.val[CommandUI.Controls.a.InnerHTML]||(f=t.val.MenuItemId,t.val[CommandUI.Controls.a.InnerHTML]=this.f(f))}},ct:function(n){var t,i,r;return this.P.a(635)&&(t=this.cf(n),t)?t:(i=this.ce(n),i)?i.DomainId:this.P.a(635)?(Diag.a.a(592843910,0,10,"Could not convert key into domain: {0}",n),null):(r=this.cv(n),!r)?(Diag.a.a(593241929,0,10,"Could not convert key into domain using fallback logic, Key: {0}",n),null):(t={},t.Id=r,t.StringId=null,t)},cv:function(n){var t=parseInt(n),i,r;return t>0?t:(Diag.a.a(593241928,0,50,"Checking for specific domains, Key: {0}",n),i=_Ewa.ClientStringManager.a().a(1559),r=_Ewa.ClientStringManager.a().a(1560),n===this.bd||n===this.bc)?parseInt(n):this.cl(n,i,"Stock")?parseInt(this.bc):this.cl(n,r,"Geography")?parseInt(this.bd):t},bx:function(n){var t={};return t.Id=n,this.a(t)},ce:function(n){return this.R.c(n)?this.R.a(n):null},ci:function(n){if(!n.startsWith("PreviewGalleryButtonIndex."))return-1;var t=parseInt(n.substr(26));return isNaN(t)?(Diag.a.a(592843909,0,10,"Unexpected index in preview gallery button key: {0}",n),-1):t},cf:function(n){var t=this.ci(n);return t<0?null:this.T[t]},cC:function(){this.bN()},cj:function(n,t,i){if(this.bk&&this.R&&this.R.e){Diag.a.a(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",n);var r=this.P.d().a().b(!1);this.P.c().a()&&_Ewa.eN.h(this.P.d().a(),_Ewa.n.a(this.bY,t),i,r,null)}},cH:function(n){if(_Ewa.S.a(n)){Diag.a.a(591147843,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.h.a(n.Errors,","));this.P.c().s(n.Errors);return}},cQ:function(){this.cj("Auto-refresh on load",null,null)},cR:function(){if(this.bk&&this.R&&this.R.e){if(this.bb){Diag.a.a(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one");return}var n=this.P.c().l().HasAutoRefreshableLinkedEntityDomainsEver;if(!n){Diag.a.a(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created");return}Diag.a.a(51659663,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context");this.bb=_Ewa.x.a().a(this.bt,this.bq,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}},cs:function(){Diag.a.a(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.bq);this.cj("Periodic auto-refresh check",this.bW,this.bV)},cB:function(n){if(_Ewa.S.a(n)?(Diag.a.a(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.h.a(n.Errors,",")),++this.bv):this.bv=0,System.a.a(this.bb),this.bv>=this.cc){Diag.a.a(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh");this.bb=null;return}Diag.a.a(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext");this.bb=_Ewa.x.a().a(this.bt,this.bq,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},cA:function(n){var t=_Ewa.W.a(n.b);!t||!t.length?Diag.a.a(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):Diag.a.a(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",_Ewa.h.a(t,","));System.a.a(this.bb);this.bb=_Ewa.x.a().a(this.bt,this.bq,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},cl:function(n,t,i){return _Ewa.e.c(n,t,!0)||_Ewa.e.c(n,i,!0)},cK:function(n){var t=!!n.Result&&n.Result,i;Diag.a.a(591958236,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",t.toString());t?(i=_Ewa.u.a().b().m-this.bz,Diag.a.a(589947468,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",i,this.bo),this.k()):this.bE()},cJ:function(){Diag.a.a(591958235,0,15,"OnNotifyFeatureLicensingStatusFailed");this.bE()},bE:function(){var n;if(this.P.c().a()&&this.bg!=null&&this.bn!=null&&this.bC!=null&&this.bB!=null)if(++this.bo,this.bo<=12){this.bo===1&&(this.bz=_Ewa.u.a().b().m,Diag.a.a(589947467,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var t=this.P.d().a().b(!1),i=[this.bg||this.bn,this.bC,this.bB];_Ewa.j.Q(this.P.d().a(),["ExcelAdvancedAnalytics","ExcelWolframAlpha","StockHistory"],i,this.ca,this.bZ,t)}else n=_Ewa.u.a().b().m-this.bz,Diag.a.a(591958231,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",n),this.W=-1,this.bQ()},bM:function(n){if(n||this.P.k()){if(this.bg!=null){this.bE();return}var i=_Ewa.u.a().b().m,t=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a,null).a(function(n){n.a("ExcelAdvancedAnalytics",!1).then(function(n){var r=_Ewa.u.a().b().m;return Diag.a.a(591958230,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelAdvancedAnalytics",r-i),Diag.a.a(591958229,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelAdvancedAnalytics",n),t.bg=!n&&t.P.a(632)?!0:n,n}).then(function(){n.a("ExcelPowerBiPro",!1).then(function(n){var r=_Ewa.u.a().b().m;return Diag.a.a(590747350,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",r-i),Diag.a.a(590747349,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",n),t.bn=n,n})}).then(function(){n.a("ExcelWolframAlpha",!1).then(function(n){var r=_Ewa.u.a().b().m;return Diag.a.a(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",r-i),Diag.a.a(590960587,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",n),t.bC=n,n})}).then(function(){n.a("StockHistory",!1).then(function(n){var r=_Ewa.u.a().b().m;return Diag.a.a(579081472,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",r-i),Diag.a.a(579081443,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",n),t.bB=n,t.bE(),n})})})}}};_Ewa.uu=function(n){_Ewa.uu.initializeBase(this);this.a=n;this.e()};_Ewa.uu.a=function(n){n.b().b(_Ewa.xf.$$(_Ewa.eq),272,new _Ewa.uu(n))};_Ewa.uu.prototype={a:null,p:function(){var n=_Ewa.l.a(_Ewa.dG,this.a.b(),102,this.a.i(),this.c,null),t;if(this.a.C())t=this,_Ewa.f.cw(_Ewa.f.ws([n],this.b(),3),function(){t.d(t.a.b().a(_Ewa.eq,271,!1,null)||new _Ewa.fr(t.a,n.a(),null,null))},this.a.i(),3);else{var r=_Ewa.l.b(_Ewa.qs,this.a.b(),257,258,this.c,null),u=_Ewa.cu.a(this.a),i=this;_Ewa.f.cw(_Ewa.f.ws([n,r,u],this.b(),3),function(){i.d(i.a.b().a(_Ewa.eq,271,!1,null)||new _Ewa.fr(i.a,n.a(),r.a(),u.a()))},this.a.i(),3)}}};_Ewa.pC=function(n,t){this.j=n;this.h=t};_Ewa.pC.a=function(n){return n.replace(new RegExp("\\n","g"),"&#010;")};_Ewa.pC.prototype={k:2,i:"Size64by48",j:null,h:null,c:function(n,t,i){var r=this.r(n,t,i);return r.b()},r:function(n,t,i){var u=this.j.c(t),f,e,r;if(n&&n.length>0){f=this.j.b();u.a().push(f);e=this.j.e("ConvertToLinkedEntitySeeMore",this.k,this.i,null);for(var s=n,c=s.length,o=0;o<c;++o)if((r=s[o],!r.DomainId.StringId)&&!r.DomainBlocked&&(!i||r.ShowInRibbon)){var h=r.DomainId.Id.toString(),l=this.v(r.Name),a=r.Name;e.c(0,"Data.ConvertToLinkedEntityMenuItem_"+h,-1203788282,"QueryLinkedEntityGalleryIcon",r.Description,h,l,null,null,null)}Array.add(f.a(),e)}return u.a().length||Diag.a.a(34415008,0,15,"No domain data available"),u},d:function(n,t,i){var y,o,u,c,l,r,w;this.n(!0);for(var b=this.j.c(t),f=b.b(),a=0,v=n.Categories,k=v.length,e=0;e<k;++e)y=v[e],o=this.t(y,a),o&&(Array.add(f.MenuSectionList,o),++a);if(i){for(var d=this.j.b(),s=d.d(),g=_Ewa.t.a(11),p=n.LongButtons,nt=p.length,h=0;h<nt;++h)if(u=p[h],this.h.m(u)){if(c="Data.ConvertToLinkedEntityMenuItem_"+u.Name,l=this.h.a(u.DomainId),!l)continue;w=(r=new Common.bW,r.Id=c,r.ExternalId=c,r.Command="-1662108744",r.LabelText=u.Name,r.Alt=u.SuperTip,r.Visible=!0,r.MenuItemId=_Ewa.fr.a(u.DomainId),r.Image16by16=g,r.Image16by16Class=this.l(l.FontLocator,!0),r);Array.add(s.ControlList,w)}s.ControlList.length>0&&Array.add(f.MenuSectionList,s)}return f},e:function(n){var t=this.l(n.FontLocator,!1),i=Common.d.b(n.Name),r=Common.d.b(n.Description);return _Ewa.fr.b(t,_Ewa.t.a(11),i,r,!0)},f:function(n,t){var r=24,u={width:r,"min-width":r,height:r},i;return i=new Common.dy,i.Id="ConvertToLinkedEntityPreview"+n.toString(),i.ExternalId="ConvertToLinkedEntityPreview"+n.toString(),i.MenuItemId="PreviewGalleryButtonIndex."+n.toString(),i.Command="-1203788282",i.QueryCommand="QueryLinkedEntityGalleryButtons",i.Icon=this.m(t.FontLocator),i.LabelText=t.Name,i.PreviewIconStyle={root:u},i.Alt=this.g(t),i},t:function(n,t){for(var u,i,l,f,a,e,o,s=this.j.e("ConvertToLinkedEntitySection_"+t,this.k,this.i,null),h=!1,c=n.DomainIds,v=c.length,r=0;r<v;++r)(u=c[r],i=this.h.a(u),i&&!i.DomainBlocked&&i.ShowInRibbon)&&(l=i.Name,f=_Ewa.fr.a(u),s.a("Data.ConvertToLinkedEntityMenuItem_"+f,-1203788282,"QueryLinkedEntityGalleryIcon",0,f,this.m(i.FontLocator),null,null,this.g(i),l),h=!0);return h?(a=s.b(!0),e=this.j.b(),e.c(n.Name),o=e.d(),Array.add(o.ControlList,a),o):null},v:function(n){return n==="Stocks"?"Bank_32":n==="Geography"?"OpenMap_32":"ConvertToEntity_32"},m:function(n){switch(n){case"AppleRibbon":return"AppleExcelDataTypes_24";case"AtomRibbon":return"AtomExcelDataTypes_24";case"BeakerRibbon":return"BeakerExcelDataTypes_24";case"CenterMapRibbon":return"CenterMapExcelDataTypes_24";case"ExerciseRibbon":return"ExerciseExcelDataTypes_24";case"FinanceRibbon":return"Bank_32";case"GradCapRibbon":return"GradCapExcelDataTypes_24";case"LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case"MapRibbon":return"OpenMap_24";case"MovieRibbon":return"MovieExcelDataTypes_24";case"OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case"PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case"SatelliteRibbon":return"SatelliteExcelDataTypes_24";case"WolframGenericRibbon":return"Lightning_24";default:return"ConvertToEntity_20"}},a:function(n,t,i){var f=[],r,o,s,h,c;if(n)for(var e=n,l=e.length,u=0;u<l;++u)(r=e[u],r.DomainId.StringId)||r.DomainBlocked||(!i||r.ShowInRibbon)&&(o=r.DomainId.Id.toString(),s=r.Name,Array.add(f,this.o(s,"-1203788282","QueryLinkedEntityMenuGalleryButtons",o)));return h=this.q(t,[Common.w.h("ConvertToLinkedEntitySeeMore",this.i,this.k.toString(),f)],!1),c=[h],Common.w.c(c)},b:function(n,t,i){var f,u,v,s,e,y,r,c,l,w,b,k;this.n(!1);f=[];u=0;for(var a=n.Categories,d=a.length,o=0;o<d;++o)v=a[o],s=this.u(t,u,v),s&&(f.push(s),++u);if(i){e=[];y=_Ewa.t.a(11);for(var p=n.LongButtons,g=p.length,h=0;h<g;++h)if(r=p[h],this.h.m(r)){if(c=_Ewa.fr.a(r.DomainId),l=this.h.a(r.DomainId),!l)continue;w=this.s("Data.ConvertToLinkedEntityMenuItem_"+c,"-1662108744","QueryLinkedEntityMenuGalleryButtonsRedesign",c,r.Name,y,this.l(l.FontLocator,!0),r.SuperTip);Array.add(e,w)}e.length>0&&(b=Common.w.d("ConvertToLinkedEntitySection_"+u.toString(),e),k=Common.w.b(t+u.toString(),b,null,null,null,null,null),f.push(k))}return Common.w.c(f)},p:function(n,t,i,r,u,f,e,o){var h=Common.d.b(o),s=_Ewa.pC.a(h),c=Common.d.b(u),l=Common.d.c(_Ewa.fr.b(e,f,c,s,!0)),a=Common.d.c(n),v=Common.d.c(r);return String.format('<GalleryButton InnerHTML="{0}" Id="{1}" Command="{2}" QueryCommand="{3}" MenuItemId="{4}" ElementDimensions="{5}" Alt="{6}"/>',l,a,t,i,v,this.i,s)},l:function(n,t){if(t&&n!=="PowerBIRibbon")return"ewadata_ConvertToEntityIcon16";switch(n){case"AppleRibbon":return"ewadata_Apple32";case"AtomRibbon":return"ewadata_Atom32";case"BeakerRibbon":return"ewadata_Beaker32";case"CenterMapRibbon":return"ewadata_CenterMap32";case"ExerciseRibbon":return"ewadata_Exercise32";case"FinanceRibbon":return"ewadata_StockLinkedEntity32";case"GradCapRibbon":return"ewadata_GradCap32";case"LocationPointerRibbon":return"ewadata_LocationPointer32";case"MapRibbon":return"ewadata_GeographyLinkedEntity32";case"MovieRibbon":return"ewadata_Movie32";case"OuterSpaceRibbon":return"ewadata_OuterSpace32";case"PowerBIRibbon":return t?"ewadata_OrganizationData16":"ewadata_OrganizationData32";case"SatelliteRibbon":return"ewadata_Satellite32";case"WolframGenericRibbon":return"ewadata_Lightning32";default:return"ewadata_ConvertToEntityIcon32"}},u:function(n,t,i){for(var e,r,o,h,c,l,u=[],a=_Ewa.t.a(11),s=i.DomainIds,v=s.length,f=0;f<v;++f)(e=s[f],r=this.h.a(e),r&&!r.DomainBlocked&&r.ShowInRibbon)&&(o=_Ewa.fr.a(e),h=this.p("Data.ConvertToLinkedEntityMenuItem_"+o,"-1203788282","QueryLinkedEntityMenuGalleryButtonsRedesign",o,r.Name,a,this.l(r.FontLocator,!1),this.g(r)),Array.add(u,h));return u.length?(c=Common.w.h("ConvertToLinkedEntitySection_"+t.toString(),this.i,this.k.toString(),u),l=Common.w.b(n+t.toString(),c,null,i.Name,null,null,null),l):null},s:function(n,t,i,r,u,f,e,o){var s=Common.d.c(o),h=_Ewa.pC.a(s),c=Common.d.c(u),l=Common.d.c(n),a=Common.d.c(r);return Common.w.e(l,t,c,f,e,a,null,h,null,null,i,null,null,null,!0,null,null,null,null,null,null,null)},q:function(n,t,i){return Common.w.b(n,i?Common.w.d(null,t):t[0],null,null,null,null,null)},o:function(n,t,i,r){return String.format('<GalleryButton InnerHTML="" Id="{0}" Command="{1}" QueryCommand="{2}" MenuItemId="{3}" ElementDimensions="{4}"/>',n,t,i,r,this.i)},n:function(n){var i,t,r;if(n)this.k=5;else{for(i=this.h.c(),t=i-1;t>=5;--t)if(r=this.h.h(t,n),_Ewa.i.be(r))break;this.k=t+1}this.i=n?"Size112by64":"Size70by48"},g:function(n){return!n.RibbonTooltipHeader||!n.RibbonTooltipHeader.length?n.RibbonTooltip:n.RibbonTooltipHeader+"\n\n"+n.RibbonTooltip}};_Ewa.eN=function(){};_Ewa.eN.d=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.selectedRanges=t,s.domainId=i,s.autodetect=r,_Ewa.j.a(n,"ConvertToLinkedEntity",s,u,f,e,4,null)};_Ewa.eN.j=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"OnAutoDetectUIShown",f,t,i,r,4,null)};_Ewa.eN.g=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"GetLinkedEntityServiceDomains",f,t,i,r,4,null)};_Ewa.eN.f=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"GetLinkedEntityMetadata",f,t,i,r,4,null)};_Ewa.eN.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.j.a(n,"ConvertLinkedEntityToText",e,i,r,u,4,null)};_Ewa.eN.k=function(n,t,i,r,u,f){var e=n.a(1,f);return e.activeCell=t,_Ewa.j.a(n,"RefreshLinkedEntities",e,i,r,u,4,null)};_Ewa.eN.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isChangeObject=i,_Ewa.j.a(n,"GetLinkedEntityDisambiguationData",o,r,u,f,4,null)};_Ewa.eN.m=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,o.selectionIndex=i,_Ewa.j.a(n,"SelectLinkedEntityForDisambiguation",o,r,u,f,4,null)};_Ewa.eN.l=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.searchQuery=i,_Ewa.j.a(n,"SearchLinkedEntity",o,r,u,f,4,null)};_Ewa.eN.i=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isBackward=i,_Ewa.j.a(n,"MoveToNextAmbiguousLinkedEntity",o,r,u,f,4,null)};_Ewa.eN.b=function(n,t,i,r,u,f){var e=n.a(9,f);return e.activeCell=t,_Ewa.j.a(n,"CancelSearchLinkedEntity",e,i,r,u,4,null)};_Ewa.eN.e=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,o.letyDomainId=i,_Ewa.j.a(n,"GetDataTypeSelectorData",o,r,u,f,4,null)};_Ewa.eN.h=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.j.a(n,"LinkedEntityTryAutoRefresh",f,t,i,r,0,null)};_Ewa.FX=function(n){_Ewa.FX.initializeBase(this,[n])};_Ewa.FX.prototype={dispose:function(){Common.App.Enrichment.g.prototype.dispose.call(this)}};_Ewa.nh=function(n,t,i){this.n=Function.createDelegate(this,this.p);this.b=this.cy;this.d=this.cu;_Ewa.nh.initializeBase(this,[n,null]);this.i=t;this.m=i;_Ewa.bf.a(t).a(this);this.i.G(this.n)};_Ewa.nh.a=function(n,t){var u=n.m(),i=document.getElementById(u+"m_enrichmentTaskPane"),f,r,e;return i||(i=CommonUI.a.a("div",n.m()+"m_enrichmentTaskPane","cui-taskpane"),f=document.getElementById(u+"novTaskpaneBody"),f.appendChild(i)),r=n.b(),e=r.a(_Ewa.nh,257,!1,null)||r.b(_Ewa.nh,257,new _Ewa.nh(i,n,t)),e};_Ewa.nh.prototype={m:null,P:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},T:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cx("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cA("EnrichmentTaskPaneOnFocus",n)},cy:function(){return _Ewa.pb.prototype.cy.call(this)},cu:function(n){return _Ewa.pb.prototype.cu.call(this,n),this.cr("EnrichmentTaskPaneVilibilityChanged",null),n},bD:function(){return this.cy()},bj:function(){return"ETP"},a:function(){return 10},t:function(){return"ewanov_linkedrecordPane"},u:function(){return"Enrichment"},j:function(){return 300},o:0,v:function(){return this.o},U:function(n){return this.o=n,n},R:function(){return!1},F:function(){return this.cp()},l:!1,i:null,k:function(){},Q:function(){},g:function(){return this.l},h:function(){return this.l},w:function(){},dispose:function(){this.i&&this.i.H(this.n);this.i=null;this.m=null;_Ewa.pb.prototype.dispose.call(this)},O:function(n,t){return t||this.cr("EnrichmentTaskPaneOnFocus",null),!t},dL:function(n){return _Ewa.a.e(this.F(),n)},cH:function(){},bO:function(){},c:function(n){this.l=n;var t=this.m;this.cu(n);n&&t.c().length>0&&(!t.a()||t.a().a().a()!==10||t.e())&&t.d(this,!0);t.b();n||(_Ewa.b.a(this.i).O(!0,!1),this.i.x())},S:function(){return!1},p:function(){this.c(!1)}};_Ewa.uv=function(n){_Ewa.uv.initializeBase(this);this.a=n;this.e()};_Ewa.uv.a=function(n){n.b().b(_Ewa.xf.$$(_Ewa.qs),258,new _Ewa.uv(n))};_Ewa.uv.prototype={f:null,g:null,i:function(){if(!this.f){var n=this;this.f=_Ewa.f.cw(_Ewa.cu.a(this.a),function(t){n.g=_Ewa.nh.a(n.a,t.a())},this.b(),3)}return this.f},a:null,p:function(){var t=_Ewa.l.a(Sys.IDisposable,this.a.b(),203,this.b(),this.c,null),i=_Ewa.l.a(Object,this.a.b(),155,this.b(),this.c,null),r=this,n=this;_Ewa.f.cw(_Ewa.f.tc(_Ewa.f.ws([t,i],this.b(),3),function(){return r.i()},this.b()),function(){n.d(n.g)},this.b(),3)},dispose:function(){this.a=null;this.f=null;this.g=null;_Ewa.rw.prototype.dispose.call(this)}};_Ewa.FW=function(n){_Ewa.FW.initializeBase(this,[Common.a.b().e(),Common.a.b().f(),Common.a.b().k(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.t)};_Ewa.FW.prototype={f:null,B:function(){return this.f.F()},E:function(){this.f.b()||this.f.c(!0)},D:function(){this.f.c(!1)},dispose:function(){this.f&&(this.f.f(this.t),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.Dl=function(n,t,i,r){_Ewa.Dl.initializeBase(this,[!1]);this.c=n;this.a=i.c(n,t,"",_Ewa.t.a(11),r,"AutoDetectPointerDown",_Ewa.ClientStringManager.a().a(1571)+"...")};_Ewa.Dl.prototype={c:null,a:null,b:function(){return this.a.c()},dispose:function(){this.a.dispose();this.c=null;_Ewa.bcL.prototype.dispose.call(this)},f:function(n){return this.a.b(n)},g:function(n){return this.a.d(n,!1)},i:function(n,t,i,r){this.a.l(_Ewa.ti.a(n),t,r,!1);this.a.k(i,t,r,!1)},e:function(n,t){var r=_Ewa.b.a(this.c),u=r.f().b(n),i=r.x(n,u,!1,!1),f=r.n(u).J(),h;if(i&&i.a.a>=0&&i.a.b>=0&&f.c()>i.c()+160){var e=i.b.a+this.b(),o=i.a.b+this.b(),s=!1;if(e+160>f.b.a&&(e=i.a.a-this.b(),s=!0),h=o<f.a.b+this.b(),h){if(r.f().m()){this.d();return}o=f.a.b+this.b()}this.a.g(t,"AutoDetectHover",u);this.h(e,o,r.d(),u,s)}else this.d()},h:function(n,t,i,r,u){this.a.a(n,t,i,r,!1,u)},d:function(){this.a.e()}};_Ewa.Dm=function(n,t){this.i=t;this.c=n};_Ewa.Dm.prototype={i:null,c:null,b:null,d:null,a:null,h:null,g:null,f:null,e:null,j:function(){var t=this.k(),n=this;_Ewa.fS.a(_Ewa.gk,this.i,243,242,0,function(i){n.b=i;i.f(n.c,2,t,!1,!0)},null)},l:function(){this.b&&this.b.b(-1,-1,this.c)},k:function(){var n={};return n.layoutId="AutoDetectTooltip",n.description=this.a,n.convertToDomainName=this.d,n.longDescription=this.a,n.urlValue=this.h,n.imageAltText=this.g,n.helpText=this.f,n.helpId=this.e,n.fields=["placeholder"],n}};_Ewa.ti=function(n,t,i){this.p=Function.createDelegate(this,this.z);this.n=Function.createDelegate(this,this.F);this.q=Function.createDelegate(this,this.I);this.o=Function.createDelegate(this,this.G);this.h=Function.createDelegate(this,this.H);this.v=Function.createDelegate(this,this.E);this.x=Common.c.d();_Ewa.ti.initializeBase(this,[!1]);this.b=n;this.j=n.a(920);this.e=i;i.k();this.d=new _Ewa.Dl(n,this.v,t,"");this.r=new _Ewa.Dn(this.b,i);this.a=_Ewa.b.a(this.b);this.b.a(922)?this.a.a().q(this.h):this.a.a().k(this.h);this.a.h().p(this.h);this.a.w(this.o);this.b.G(this.q);this.b.Q(this.n);this.l=$$as(_Ewa.hQ,this.a.b());this.m()};_Ewa.ti.a=function(n){return _Ewa.ClientStringManager.a().a(1571)+" "+n};_Ewa.ti.prototype={e:null,r:null,d:null,a:null,l:null,b:null,g:-1,k:null,f:-1,i:!1,c:null,j:!1,B:function(){return this.d.f(1)},s:function(){if(this.b.k()&&this.b.a(168)&&this.b.a(172)){var n=new _Ewa.bX(this.b.f());if(n.c())return!1}return this.f!==-1},dispose:function(){if(this.a&&(this.b.a(922)?this.a.a().t(this.h):this.a.a().i(this.h)),this.b){var n=this.b;n.H(this.q);n.S(this.n);_Ewa.b.a(n).y(this.o)}System.a.a(this.d);this.d=null;this.a=null;this.b=null;_Ewa.bcL.prototype.dispose.call(this)},t:function(){this.z(null,!1);this.g=-1;this.d.d()},y:function(){this.s()&&this.g!==-1&&this.e.I()},A:function(n,t){for(var r,f,e=new _Ewa.p(n.a===1?1:n.a-1,n.b,n.c,n.d,!0,!1),o=this.a.C(e),u=o,s=u.length,i=0;i<s;++i)if(r=u[i],_Ewa.iL.isInstanceOfType(r)&&(f=r,this.u(n,t,f)))return!0;return!1},w:function(){if(this.s()&&this.g!==-1){this.d.g(1).b();var n={};n.Id=this.f;n.StringId=null;this.e.g(n,!0,this.k);Diag.a.a(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");this.f=-1}},C:function(){var n=new Sys.StringBuilder(_Ewa.ClientStringManager.a().a(1524));if(this.f!==-1){n.append(" ");try{n.append(this.e.j(this.f.toString()))}catch(t){Diag.a.a(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.f)}}return n.append(" "),n.append(_Ewa.ClientStringManager.a().a(this.x?1526:1525)),n.toString()},H:function(){this.s()&&this.a&&this.m()},I:function(){this.t()},E:function(){this.w();_Ewa.b.a(this.b).O(!0,!1)},z:function(n,t){var r,i;t?(this.J(this.k),this.j&&(this.c||(this.c=new _Ewa.Dm(this.B(),this.b)),r=this.g.toString(),this.c.d="Discover the power of data types!",this.c.a=this.e.n(r),this.c.h="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.c.g="Image Description",this.c.e="HID_DataTypes_Wolfram",this.c.f="Learn more...",this.c.j())):(i=[29],this.a.k().b(i),this.a.k().a(null,i,!0),this.c&&this.c.l())},F:function(){this.D()&&this.d.d();var n=this.a.a().c();n===1&&this.m()},G:function(){var n=this.a.a().a().a(),t=this.a.a().c();n&&t===1&&this.m()},u:function(n,t,i){var e=new _Ewa.p(i.a,i.b,i.c===1048576?i.c:i.c+1,i.d,!0,!1),r,u,f;return e.i(n)?(t&&(r=i,r&&r.q!==this.g&&(this.g=r.q,u=r.q.toString(),f=this.j?"":this.e.n(u),this.d.i(this.e.j(u),f,this.e.D(u),1)),this.f=r.q,this.k=i),!0):!1},m:function(){var r,n;if(this.e){var e=!!this.l&&this.l.I(),o=this.a.a().a().j(),s=this.a.a().c(),u=this.b.a(687);if(!e||!o&&!u||s!==1){this.t();return}for(var t=this.a.a().a().a(),h=this.a.q(),c=this.a.C(h),f=c,l=f.length,i=0;i<l;++i)if(r=f[i],_Ewa.iL.isInstanceOfType(r))if(n=r,u)switch(n.t){case 3:if(this.u(t,!0,n)){Diag.a.a(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.d.e(t,this.p);this.i||(this.i=!0,this.y());return}break;case 2:case 1:this.r.f(n);break;default:Diag.a.a(593266063,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else if(this.u(t,!0,n)){Diag.a.a(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.d.e(t,this.p);this.i||(this.i=!0,this.y());return}this.t()}},J:function(n){var t=[29];this.a.k().a(n,t,!0);this.a.k().c(t,null,null)},D:function(){return this.b.c().b()&&_Ewa.z.a(this.b.j())}};_Ewa.tj=function(n,t){this.c=Function.createDelegate(this,this.f);_Ewa.tj.initializeBase(this,[!1]);this.b=n;this.d=t;this.a=document.createElement("div");this.a.className="clip16x16";this.e=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',Common.d.b("autodetectid"+this.b.b),"ewadata_ConvertToEntityIcon16",_Ewa.t.a(11));this.a.innerHTML=this.e;var i=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().a("click",i,this.c)};_Ewa.tj.prototype={e:"",d:null,b:null,a:null,dispose:function(){if(this.a){var n=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.i.a().b("click",n,this.c)}_Ewa.bcL.prototype.dispose.call(this)},f:function(n){if(n.c.id===this.a.firstChild.id){var t=this.b,i={};return i.Id=t.q,this.d.g(i,!0,t),this.a.removeChild(this.a.firstChild),!0}return!1}};_Ewa.Dn=function(n,t){_Ewa.Dn.initializeBase(this,[!1]);this.d=n;this.b=_Ewa.b.a(n);this.c=t;this.a=new($$sc.r.$$(_Ewa.tj))};_Ewa.Dn.prototype={d:null,b:null,c:null,a:null,dispose:function(){_Ewa.bcL.prototype.dispose.call(this)},f:function(n){for(var r=this.b.bk().$$ge(),u,t;r.$$mn();)for(u=r.$$cu(),t=u.$$ge();t.$$mn();){var i=t.$$cu(),e=i.b(),f=_Ewa.qn.a(i.e());this.e(n,f,e);i.l(f)}},e:function(n,t,i){var u,f,r;if(t.length&&(u=i.length,!(i[u-1]<n.b))&&(f=_Ewa.i.g(new _Ewa.dA(i),0,u,n.b,_Ewa.i.i),!(f<0))&&(r=t[f],r)){this.b.d()?Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-rtl"):Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-ltr");this.a.d(n.b)||this.a.c(n.b,new _Ewa.tj(n,this.c));var e=this.a.a(n.b),o=e.a,s=r.getElementsByClassName("clip16x16");!s.length&&this.g(r)&&r.appendChild(o)}},g:function(n){var u=parseInt(n.style.width),i=this.d.b().a(_Ewa.cF,268,!1,null),r,t;if(!i)return Diag.a.a(593266065,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton IInstantaneousSupportInformationManager not initialized in time for rendering Auto Detect Column Header Button"),!0;if(r=i?i.b():null,!r)return Diag.a.a(593266064,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton NumberFormattingCalculator not initialized in time for rendering Auto Detect Column Header Button"),!0;t={};t.fontVariant="normal";t.fontStyle="normal";t.fontFamily='"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif';t.fontSize="10pt";t.fontWeight=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";t.lineHeight="normal";t.letterSpacing="0px";var f=r.calculateTextWidth(n.firstChild.innerHTML,t),e=u-(u/2+f/2);return e>16*.9+4?!0:!1}};_Ewa.FU.registerClass("_Ewa.FU",null,_Ewa.kx);_Ewa.ut.registerClass("_Ewa.ut",_Ewa.bc);_Ewa.FY.registerClass("_Ewa.FY");_Ewa.FV.registerClass("_Ewa.FV",null,Sys.IDisposable);_Ewa.fr.registerClass("_Ewa.fr",_Ewa.cg,_Ewa.eq,Common.App.Enrichment.m,Sys.IDisposable);_Ewa.uu.registerClass("_Ewa.uu",_Ewa.rw.$$(_Ewa.eq));_Ewa.FX.registerClass("_Ewa.FX",Common.App.Enrichment.g);_Ewa.nh.registerClass("_Ewa.nh",_Ewa.pb,_Ewa.qs,Sys.IDisposable,_Ewa.bgr,_Ewa.nN);_Ewa.uv.registerClass("_Ewa.uv",_Ewa.rw.$$(_Ewa.qs));_Ewa.FW.registerClass("_Ewa.FW",Common.App.Enrichment.a);_Ewa.Dl.registerClass("_Ewa.Dl",_Ewa.bcL);_Ewa.Dm.registerClass("_Ewa.Dm");_Ewa.ti.registerClass("_Ewa.ti",_Ewa.bcL);_Ewa.tj.registerClass("_Ewa.tj",_Ewa.bcL);_Ewa.Dn.registerClass("_Ewa.Dn",_Ewa.bcL);Type.registerNamespace("_Ewa");_Ewa.bbE=function(){};_Ewa.bbE.a=function(){_Ewa.k.a(function(n){_Ewa.uv.a(n);_Ewa.uu.a(n);_Ewa.ut.a(n)})};_Ewa.bbE.a();