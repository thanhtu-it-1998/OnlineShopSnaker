!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24);t.getAccessToken=n.getAccessToken,t.getMlapiAccessToken=n.getMlapiAccessToken,t.setUserAccessInfo=n.setUserAccessInfo,t.setAdminAccessToken=n.setAdminAccessToken,t.getAdminAccessToken=n.getAdminAccessToken;var o=r(25);t.setNodeFetch=o.setNodeFetch,t.usingNodeFetch=o.usingNodeFetch;var i=r(11);t.getDelay=i.getDelay,t.inDevMode=i.inDevMode,t.useLocalStorage=i.useLocalStorage;var a=r(26);t.getSessionId=a.getSessionId,t.setSessionId=a.setSessionId;var s=r(27);t.buildAdminUrl=s.buildAdminUrl,t.buildStorageUrl=s.buildStorageUrl,t.setStorageEnvironmentOverride=s.setStorageEnvironmentOverride;var c=r(10);t.setFlightValue=c.setFlightValue},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CXPSStrings={Namespace:"http://schemas.microsoft.com/office/extensibility/maker/v1.0",ScriptIdNodeTag:"scriptId",ScriptIdsNodeId:"script-ids-node-id"},t.StorageResourceIdFirstParty="https://officescripting.microsoft.com",t.StorageResourceIdFirstPartyTest="https://officescripting-test.microsoft.com",t.StorageResourceIdThirdParty="93649854-d49a-4352-9737-280fbe867971",t.SERVICE_URLS={prod:"https://api.public.officescriptsservice.com/api",prodNew:"https://api.officescripts.microsoftusercontent.com/api",int:"https://api.runtime.arbitraryrunner.com/api",test:"https://api.test.arbitraryrunner.com/api",local:"http://localhost:30002/api"},t.MLAPI_MAKER_SCOPE="Microsoft.Internal.OfficeScriptingConsentScopes",t.MLAPI_URL="https://substrate.office.com/profile/v1.0/me/allExtensions/Microsoft.Internal.OfficeScriptingConsentScopes",t.MAX_SCRIPT_NAME_LENGTH=80,t.MAX_SCRIPT_DESCRIPTION_LENGTH=500,t.SIMULATED_DELAY=50,t.NUM_MILLISECONDS_PER_SECOND=1e3,function(e){e[e.WorkbookCustomXMLMalformed=-2]="WorkbookCustomXMLMalformed",e[e.WorkbookCustomXMLNotFound=-1]="WorkbookCustomXMLNotFound",e[e.ServiceUnavailable=0]="ServiceUnavailable",e[e.UnexpectedException=1]="UnexpectedException",e[e.UnhandledException=2]="UnhandledException",e[e.AccessDenied=3]="AccessDenied",e[e.AsyncProcessingError=4]="AsyncProcessingError",e[e.ItemNotFound=5]="ItemNotFound",e[e.MaxItemCountExceeded=6]="MaxItemCountExceeded",e[e.NameAlreadyExists=7]="NameAlreadyExists",e[e.NotAllowed=8]="NotAllowed",e[e.PayloadTooLarge=9]="PayloadTooLarge",e[e.GraphItemContentsInvalid=10]="GraphItemContentsInvalid",e[e.InvalidFileName=11]="InvalidFileName",e[e.InvalidRequest=12]="InvalidRequest",e[e.UserCannotShare=13]="UserCannotShare",e[e.TokenExpired=14]="TokenExpired",e[e.Timeout=15]="Timeout",e[e.GraphCommunicationFailed=16]="GraphCommunicationFailed",e[e.PlatformDisabled=17]="PlatformDisabled"}(t.StorageErrorCode||(t.StorageErrorCode={})),t.flightHeaderPrefix="x-ms-flight-"},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateNextScriptName=function(e,t,r){if(void 0===r&&(r=!1),e.includes(t)||!r){for(var n=1;e.includes(t+" ("+n+")");)n++;return t+" ("+n+")"}return t},t.pause=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(35),a=r(16);function s(e){a.setFlightHeader(e,"AutomateOnByDefault")}t.makeGetRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return s(r),n={customHeaders:r},[2,i.makeHttpRequest(e,"GET",n,!0,t)]}))}))},t.makePostRequest=function(e,t,r,a){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return s(a),n={requestBody:t,customHeaders:a},[2,i.makeHttpRequest(e,"POST",n,!0,r)]}))}))},t.makePutRequest=function(e,t,r,a){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return s(a),n={requestBody:t,customHeaders:a},[2,i.makeHttpRequest(e,"PUT",n,!0,r)]}))}))},t.makePatchRequest=function(e,t,r,a){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return s(a),n={requestBody:t,customHeaders:a},[2,i.makeHttpRequest(e,"PATCH",n,!0,r)]}))}))},t.makeDeleteRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return s(r),n={customHeaders:r},[2,i.makeHttpRequest(e,"DELETE",n,!0,t)]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(48);t.addScriptToLocalStorage=n.addScriptToLocalStorage;var o=r(19);t.getScriptFromLocalStorage=o.getScriptFromLocalStorage;var i=r(53);t.getScriptsFromLocalStorage=i.getScriptsFromLocalStorage;var a=r(54);t.getSharedScriptFromLocalStorage=a.getSharedScriptFromLocalStorage;var s=r(55);t.removeScriptFromLocalStorage=s.removeScriptFromLocalStorage;var c=r(56);t.shareScriptToLocalStorage=c.shareScriptToLocalStorage;var u=r(57);t.unshareScriptFromLocalStorage=u.unshareScriptFromLocalStorage;var l=r(58);t.updateScriptOnLocalStorage=l.updateScriptOnLocalStorage},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(8);function i(e){var t={};return e.forEach((function(e,r){return t[r]=e})),t}t.getScriptsMap=function(){var e=JSON.parse(localStorage.getItem(n.LocalStorageKeys.recordedScriptsKey)||"{}");return o.getIsIEBrowser()&&o.loadObjectEntriesPolyfill(),new Map(Object.entries(e))},t.updateLocalStorage=function(e,t){window.localStorage.setItem(e,JSON.stringify(i(t)))},t.convertMapToObject=i,t.getSharedScriptsMap=function(){var e=JSON.parse(localStorage.getItem(n.LocalStorageKeys.sharedScriptsKey)||"{}");return o.getIsIEBrowser()&&o.loadObjectEntriesPolyfill(),new Map(Object.entries(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageKeys={recordedScriptsKey:"recorded-maker-scripts",lastOpenedScriptKey:"last-opened-script",sharedScriptsKey:"shared-maker-scripts"}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(12),a=r(38),s=r(39),c=r(40);function u(e){var t=e.split(".");if(2===t.length)return{major:parseInt(t[0],10),minor:parseInt(t[1],10)};throw new Error("Invalid version")}t.convertResponseJson=function(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,l,f;return o(this,(function(o){switch(o.label){case 0:return null==t?[2,a.convertResponseToScriptV0(e)]:(n=u(t),r?(f=null,[3,3]):[3,1]);case 1:return[4,i.getUserId()];case 2:f=o.sent(),o.label=3;case 3:switch(l=f,n.major){case 2:return[2,c.convertResponseToScriptV2(e,n.minor,l)];case 1:return[2,s.convertResponseToScriptV1(e)];default:throw new Error("Unsupported version")}return[2]}}))}))},t.convertResponseJsonArray=function(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,l,f;return o(this,(function(o){switch(o.label){case 0:return null==t?[2,a.convertResponseToScriptCoresV0(e)]:(n=u(t),r?(f=null,[3,3]):[3,1]);case 1:return[4,i.getUserId()];case 2:f=o.sent(),o.label=3;case 3:switch(l=f,n.major){case 2:return[2,c.convertResponseToScriptCoresV2(e,n.minor,l)];case 1:return[2,s.convertResponseToScriptCoresV1(e)];default:throw new Error("Unsupported version")}return[2]}}))}))},t.convertResponseFolderJson=function(e,t){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){if(null==t)throw new Error("Unsupported version");switch((r=u(t)).major){case 2:return[2,c.convertResponseToFolderV2(e,r.minor)];default:throw new Error("Unsupported version")}return[2]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(49);t.getIsIEBrowser=n.getIsIEBrowser;var o=r(50);t.MakerStorageError=o.MakerStorageError;var i=r(51);t.loadObjectEntriesPolyfill=i.loadObjectEntriesPolyfill;var a=r(15);t.StorageServiceError=a.StorageServiceError;var s=r(52);t.xmlSerializeToString=s.xmlSerializeToString},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28);t.convertToHierarchy=n.convertToHierarchy;var o=r(29);t.createFolder=o.createFolder;var i=r(41);t.createScript=i.createScript;var a=r(18);t.getScript=a.getScript;var s=r(20);t.getScripts=s.getScripts;var c=r(59);t.getSharedScript=c.getSharedScript;var u=r(60);t.getSharedScripts=u.getSharedScripts;var l=r(61);t.removeScript=l.removeScript;var f=r(62);t.saveScript=f.saveScript;var d=r(21);t.isScriptDescriptionValid=d.isScriptDescriptionValid,t.isScriptNameValid=d.isScriptNameValid;var p=r(65);t.shareScript=p.shareScript;var h=r(66);t.unshareScript=h.unshareScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.setFlightValue=function(e,t){n[e]=t},t.getFlightValue=function(e){var t;return null!=(t=n[e])?t:""},t.clearFlightCache=function(){n={}}},function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=function(e,t){if(!e)return n=null,void(o=0);n=e,o=t||0},t.inDevMode=function(){return!!n},t.getDelay=function(){return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30);t.getUserPermissions=n.getUserPermissions,t.getUserId=n.getUserId,t.getTenantId=n.getTenantId,t.clearUserPermissionCache=n.clearUserPermissionCache},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.mockAccessToken="eyBearerAuthmockAccessTokenfromGraphtobeSenttoRest",t.mockMlapiAccessToken="eyBearerAuthmockMLAPITokenfromtobeSenttoRest",t.mockDelay=100,t.mockDevMode=!0,t.mockSessionId="1234567890-mock-sess-ionId-bbbbbbbbbbb987654321",t.mockStorageUrl="https://maker-storage.com",t.cleanUpMockProviders=function(){n.setUserAccessInfo({currentUserToken:null,currentUserMlapiToken:null}),n.setAdminAccessToken(null),n.useLocalStorage(!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.id_first="test-script-first",t.id_second="test-script-second",t.xmlEmpty='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"></scriptIds>',t.xmlOneScript='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId></scriptIds>',t.xmlTwoScripts='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId id="'+t.id_second+'"></scriptId></scriptIds>',t.xmlMalformed='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId></scriptId></scriptIds>',t.mockRequestId="Request-uuid",t.mockTenantId="Tenant-guid",t.mockUserId="0a088C17MOCKPUID",t.mockEnableStorageErrorHandling=!0,t.mockDisableStorageErrorHandling=!1},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n,o){var i=e.call(this,r)||this;return i.status=n,i.errorCode=o,Object.setPrototypeOf(i,t.prototype),i}return o(t,e),t}(Error);t.StorageServiceError=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(10);t.setFlightHeader=function(e,t){e[n.flightHeaderPrefix+t]=o.getFlightValue(t)}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),a=r(2),s=r(4),c=r(0),u=r(3);function l(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,a,s;return o(this,(function(o){switch(o.label){case 0:return[4,u.makeGetRequest(e,c.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":c.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return a=o.sent(),s=n.headers.get("Version"),[2,i.convertResponseJson(a,s,r)]}}))}))}t.getScriptInternal=l,t.getScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return c.inDevMode()?[4,a.pause(c.getDelay())]:[3,2];case 1:return r.sent(),[2,s.getScriptFromLocalStorage(e)];case 2:return[2,l(c.buildStorageUrl()+"/"+e,t)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(8),i=r(1);t.getScriptFromLocalStorage=function(e){var t=n.getScriptsMap().get(e);if(!t)throw new o.MakerStorageError("Script does not exist!",i.StorageErrorCode.ItemNotFound);return t}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),a=r(2),s=r(4),c=r(0),u=r(3);function l(e,t,r){return void 0===r&&(r=!0),n(this,void 0,void 0,(function(){var n,a,s;return o(this,(function(o){switch(o.label){case 0:return[4,u.makeGetRequest(e,c.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":c.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return a=o.sent(),s=n.headers.get("Version"),[2,i.convertResponseJsonArray(a,s,r)]}}))}))}t.getScriptsInternal=l,t.getScripts=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return c.inDevMode()?[4,a.pause(c.getDelay())]:[3,2];case 1:return t.sent(),[2,s.getScriptsFromLocalStorage()];case 2:return[2,l(c.buildStorageUrl(),e)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.isScriptNameValid=function(e){var t=new RegExp(/^(\s*)$/);if(!e.length||t.test(e))return{error:"Name is empty"};if(e.length>n.MAX_SCRIPT_NAME_LENGTH)return{error:"Name is too long"};var r=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|(^~\$)/),o=e.match(r);if(o)return{error:"Invalid name",invalidSubstring:o[0]};var i=new RegExp(/(["*:<>?\/\\|%&\.])/),a=e.match(i);if(a)return{error:"Name contains invalid character",invalidSubstring:a[0]};var s=new RegExp(/([\s]$)/);return e.match(s)?{error:"Name ends in whitespace"}:{error:"None"}},t.isScriptDescriptionValid=function(e){return e.length<=n.MAX_SCRIPT_DESCRIPTION_LENGTH}},function(e,t,r){"use strict";!function(){if("fetch"in window||(console.log("Fetch API not found, try including the polyfill"),r(23)),"fetch"in window){var e=r(0).setUserAccessInfo,t=r(0).setSessionId,n=r(0).setFlightValue,o=r(9).getScripts,i=r(9).getSharedScript,a=r(9).getSharedScripts,s=r(12).getUserPermissions,c=r(0).setStorageEnvironmentOverride,u=r(0).useLocalStorage,l=r(9).saveScript,f=r(8).StorageServiceError;window.makerstorage={setUserAccessInfo:e,setSessionId:t,setFlightValue:n,getScripts:o,getSharedScript:i,getSharedScripts:a,getUserPermissions:s,setStorageEnvironmentOverride:c,useLocalStorage:u,saveScript:l,StorageServiceError:f}}}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return p})),r.d(t,"Request",(function(){return S})),r.d(t,"Response",(function(){return _})),r.d(t,"DOMException",(function(){return k})),r.d(t,"fetch",(function(){return P}));var n="URLSearchParams"in self,o="Symbol"in self&&"iterator"in Symbol,i="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in self,s="ArrayBuffer"in self;if(s)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=v(t);return t.readAsArrayBuffer(e),r}function b(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=b(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=b(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=v(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=l(e),t=f(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},p.prototype.delete=function(e){delete this.map[l(e)]},p.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},p.prototype.set=function(e,t){this.map[l(e)]=f(t)},p.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),d(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),d(e)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function S(e,t){var r,n,o=(t=t||{}).body;if(e instanceof S){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),g.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})},m.call(S.prototype),m.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var I=[301,302,303,307,308];_.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})};var k=self.DOMException;try{new k}catch(e){(k=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),k.prototype.constructor=k}function P(e,t){return new Promise((function(r,n){var o=new S(e,t);if(o.signal&&o.signal.aborted)return n(new k("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new _(o,n))},a.onerror=function(){n(new TypeError("Network request failed"))},a.ontimeout=function(){n(new TypeError("Network request failed"))},a.onabort=function(){n(new k("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",s)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}P.polyfill=!0,self.fetch||(self.fetch=P,self.Headers=p,self.Request=S,self.Response=_)},function(e,t,r){"use strict";var n,o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.setUserAccessInfo=function(e){n=e.currentUserToken,i=e.currentUserMlapiToken},t.setAdminAccessToken=function(e){o=e},t.getMlapiAccessToken=function(){if(!i)throw new Error("Access token not set.");return i},t.getAdminAccessToken=function(){if(!o)throw new Error("Admin access token not set.");return o},t.getAccessToken=function(){if(!n)throw new Error("Access token not set.");return n}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setNodeFetch=function(e){n=!!e||null},t.usingNodeFetch=function(){return!!n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(11);t.setSessionId=function(e){n=e},t.getSessionId=function(){if(o.inDevMode())return null;if(!n)throw new Error("Session id not set.");return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1);t.setStorageEnvironmentOverride=function(e){n=e},t.buildStorageUrl=function(){return(o.SERVICE_URLS[n]||o.SERVICE_URLS.prod).concat("/storage")},t.buildAdminUrl=function(){return(o.SERVICE_URLS[n]||o.SERVICE_URLS.prod).concat("/admin")}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){for(var r=0,o=e.folders;r<o.length;r++){var i=o[r];if(i.id===t.id)return i}var a=n(n({},t),{scripts:new Set,folders:[]});return e.folders.push(a),a}Object.defineProperty(t,"__esModule",{value:!0}),t.convertToHierarchy=function(e){for(var t,r={id:"",name:"",parentId:"",scripts:new Set,folders:[]},n=0,i=e;n<i.length;n++){var a=i[n];if(null===(t=a.path)||void 0===t?void 0:t.length){for(var s=a.path,c=0,u=o(r,s[0]);c<s.length;u=++c<s.length?o(u,s[c]):u);u.scripts.add(a.id)}else r.scripts.add(a.id)}return r}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),a=r(0),s=r(3);function c(e,t,r){return n(this,void 0,void 0,(function(){var n,c,u;return o(this,(function(o){switch(o.label){case 0:return[4,s.makePostRequest(e,t,a.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":a.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return c=o.sent(),u=n.headers.get("Version"),[2,i.convertResponseFolderJson(c,u)]}}))}))}t.createFolderInternal=c,t.createFolder=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,c(a.buildStorageUrl()+"/folder",e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(31),a=r(0),s=r(2),c=r(3);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,c.makeGetRequest(e,a.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()})];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}function l(e){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return a.inDevMode()?[4,s.pause(a.getDelay())]:[3,2];case 1:return r.sent(),t.userPermissions=Promise.resolve({UserId:i.mockUserId,TenantId:i.mockTenantId,OfficeScriptingEnabled:!0,SharingEnabled:!0}),[2,t.userPermissions];case 2:return t.userPermissions=u(a.buildAdminUrl()+"/me/policy",e),[2,t.userPermissions]}}))}))}t.getUserPermissionsInternal=u,t.getUserPermissions=l,t.getUserId=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.userPermissions?[3,2]:[4,l("")];case 1:return[2,e.sent().UserId];case 2:return[4,t.userPermissions];case 3:return[2,e.sent().UserId]}}))}))},t.getTenantId=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return t.userPermissions?[3,2]:[4,l("")];case 1:return[2,e.sent().TenantId];case 2:return[4,t.userPermissions];case 3:return[2,e.sent().TenantId]}}))}))},t.clearUserPermissionCache=function(){t.userPermissions=null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(32);t.getMockContext=n.getMockContext;var o=r(33);t.getMockCustomHeaders=o.getMockCustomHeaders;var i=r(34);t.getMockScriptFromService_Unversioned=i.getMockScriptFromService_Unversioned,t.getMockScriptFromServiceV1=i.getMockScriptFromServiceV1,t.getMockScriptFromServiceV2=i.getMockScriptFromServiceV2,t.getMockScriptFromServiceV2_1=i.getMockScriptFromServiceV2_1,t.getMockScriptFromServiceV2_1Future=i.getMockScriptFromServiceV2_1Future,t.getMockScriptFromServiceV2_2=i.getMockScriptFromServiceV2_2,t.getMockScriptFromServiceV2_3=i.getMockScriptFromServiceV2_3,t.getMockScriptFromServiceV2_4=i.getMockScriptFromServiceV2_4,t.getMockScriptFolderFromServiceV2_4=i.getMockScriptFolderFromServiceV2_4;var a=r(14);t.id_first=a.id_first,t.id_second=a.id_second,t.xmlEmpty=a.xmlEmpty,t.xmlOneScript=a.xmlOneScript,t.xmlTwoScripts=a.xmlTwoScripts,t.xmlMalformed=a.xmlMalformed,t.mockRequestId=a.mockRequestId,t.mockTenantId=a.mockTenantId,t.mockUserId=a.mockUserId,t.mockDisableStorageErrorHandling=a.mockDisableStorageErrorHandling,t.mockEnableStorageErrorHandling=a.mockEnableStorageErrorHandling;var s=r(13);t.cleanUpMockProviders=s.cleanUpMockProviders,t.mockAccessToken=s.mockAccessToken,t.mockMlapiAccessToken=s.mockMlapiAccessToken,t.mockDelay=s.mockDelay,t.mockDevMode=s.mockDevMode,t.mockSessionId=s.mockSessionId,t.mockStorageUrl=s.mockStorageUrl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMockContext=function(e){return{workbook:{customXmlParts:{add:jest.fn(),getByNamespace:function(){return{getCount:function(){return{value:e}},getOnlyItem:jest.fn((function(){return{getXml:jest.fn((function(){return{value:""}})),setXml:jest.fn()}}))}}}},sync:jest.fn()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13),o=r(14);t.getMockCustomHeaders=function(){return{"x-ms-client-request-id":o.mockRequestId,"X-UserSessionId":n.mockSessionId}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}}Object.defineProperty(t,"__esModule",{value:!0}),t.getMockScriptFromService_Unversioned=function(){return{id:"testId",metadata:{dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",creatorID:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf"},body:"// <code>"}},t.getMockScriptFromServiceV1=function(){return{id:"testId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_1=o,t.getMockScriptFromServiceV2_1Future=function(){return n(n({},{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}),{futureProperty:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"})},t.getMockScriptFromServiceV2_2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_3=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_4=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",ownerEmail:"owner@example.com",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",folderId:"12345",path:[{id:"0123",name:"Folder 1",parentId:"0000"},{id:"12345",name:"Folder 2",parentId:"0123"}]}},t.getMockScriptFolderFromServiceV2_4=function(){return{id:"12345",name:"Folder 2",parentId:"0123"}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(36)),s=r(15),c=r(1),u=r(0),l=r(37),f=r(16),d=r(10);function p(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:if(e.ok)return[3,5];t=void 0,r=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.json()];case 2:return n=o.sent(),t=n.message,r=n.storageErrorCode,[3,4];case 3:return o.sent(),t="Server returned non-json response",r=c.StorageErrorCode.UnexpectedException,[3,4];case 4:throw void 0===r&&(r=c.StorageErrorCode.UnexpectedException),new s.StorageServiceError(t,e.status,r);case 5:return[2,e]}}))}))}t.makeHttpRequest=function(e,t,r,i,s){return n(this,void 0,void 0,(function(){var n,c,h,v,y;return o(this,(function(o){switch(o.label){case 0:return n=r.customHeaders,c=r.requestBody,h={method:t},v={},n&&Object.keys(n).forEach((function(e){v[e]=n[e]})),l.getIntegrationFlag()&&(d.setFlightValue("SkipTenantPolicyCache","true"),f.setFlightHeader(v,"SkipTenantPolicyCache"),d.setFlightValue("ForceSubstrate","true"),f.setFlightHeader(v,"ForceSubstrate"),d.setFlightValue("Stage4","true"),f.setFlightHeader(v,"Stage4"),d.setFlightValue("AutomateOnByDefault","true"),f.setFlightHeader(v,"AutomateOnByDefault")),s&&(v.Authorization="Bearer "+s),null!=c&&(v["Content-Type"]="application/json",h.body=JSON.stringify(c)),v["Cache-Control"]="no-store",h.headers=v,[4,(u.usingNodeFetch()?a.default:fetch)(e,h)];case 1:return y=o.sent(),i?[2,p(y)]:[2,y]}}))}))},t.handleResponse=p},function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,t.default=n.fetch.bind(n),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=!1;t.setIntegrationFlag=function(e){return n=e},t.getIntegrationFlag=function(){return n}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1);function i(e){var t=e.metadata;return{id:e.id,name:t.name,dateFirstPublished:t.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:t.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:t.creatorID}}t.convertResponseToScriptCoresV0=function(e){return e.map(i)},t.convertResponseToScriptV0=function(e){return n(n({},i(e)),{description:e.metadata.description,body:e.body})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1);function i(e){return{id:e.id,name:e.name,parameterInfo:e.parameterInfo,dateFirstPublished:e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,lastModifiedBy:e.lastModifiedBy}}t.convertResponseToScriptCoresV1=function(e){return e.map(i)},t.convertResponseToScriptV1=function(e){return n(n({},i(e)),{body:e.body,description:e.description})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1);function i(e,t){if(t<4)throw new Error("Unsupported version");return{id:e.id,name:e.name,parentId:e.parentId}}function a(e,t){return e.map((function(e){return i(e,t)}))}function s(e,t,r){var n={id:e.id,shareId:e.shareId,name:e.name,parameterInfo:e.parameterInfo,dateFirstPublished:e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,lastModifiedBy:e.lastModifiedBy,isCreator:!r||e.owner===r};if(t>=1){if(null==e.ownerDisplayName)throw new Error("Missing expected property in response");n.creatorDisplayName=e.ownerDisplayName}if(t>=4){if(null==e.path||null==e.folderId)throw new Error("Missing expected property in response");n.path=a(e.path,t),n.folderId=e.folderId}return n}t.convertResponseToFolderV2=i,t.convertResponseToFoldersV2=a,t.convertResponseToScriptCoresV2=function(e,t,r){return e.map((function(e){return s(e,t,r)}))},t.convertResponseToScriptV2=function(e,t,r){var o=n(n({},s(e,t,r)),{body:e.body,description:e.description});if(t>=2){if(null==e.apiInfo)throw new Error("Missing expected property in response");o.apiInfo=e.apiInfo}if(t>=3){if(null==e.ownerEmail)throw new Error("Missing expected property in response");o.creatorEmail=e.ownerEmail}return o}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(42));t.createScript=function(){return{id:o.default(),name:"New Script"}}},function(e,t,r){"use strict";const n=r(43),o=r(45),i=function(){return n()};i.regex={v4:/^([a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(0{8}-0{4}-0{4}-0{4}-0{12})$/,v5:/^([a-f0-9]{8}-[a-f0-9]{4}-5[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(0{8}-0{4}-0{4}-0{4}-0{12})$/},i.is=function(e){return!!e&&(i.regex.v4.test(e)||i.regex.v5.test(e))},i.empty=function(){return"00000000-0000-0000-0000-000000000000"},i.fromString=function(e){if(!e)throw new Error("Text is missing.");return o(e,"bb5d0ffa-9a4c-4d7c-8fc2-0a7d2220ba45")},e.exports=i},function(e,t,r){var n=r(44),o=r(17);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t,r){var n=r(46),o=r(47);e.exports=n("v5",80,o)},function(e,t,r){var n=r(17);e.exports=function(e,t,r){var o=function(e,o,i,a){var s=i&&a||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)),"string"==typeof o&&(o=function(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,(function(e){t.push(parseInt(e,16))})),t}(o)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(o)||16!==o.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=r(o.concat(e));if(c[6]=15&c[6]|t,c[8]=63&c[8]|128,i)for(var u=0;u<16;++u)i[s+u]=c[u];return i||n(c)};try{o.name=e}catch(e){}return o.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",o.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",o}},function(e,t,r){"use strict";function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function o(e,t){return e<<t|e>>>32-t}e.exports=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=new Array(i.length);for(var a=0;a<i.length;a++)e[a]=i.charCodeAt(a)}e.push(128);var s=e.length/4+2,c=Math.ceil(s/16),u=new Array(c);for(a=0;a<c;a++){u[a]=new Array(16);for(var l=0;l<16;l++)u[a][l]=e[64*a+4*l]<<24|e[64*a+4*l+1]<<16|e[64*a+4*l+2]<<8|e[64*a+4*l+3]}for(u[c-1][14]=8*(e.length-1)/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=8*(e.length-1)&4294967295,a=0;a<c;a++){for(var f=new Array(80),d=0;d<16;d++)f[d]=u[a][d];for(d=16;d<80;d++)f[d]=o(f[d-3]^f[d-8]^f[d-14]^f[d-16],1);var p=r[0],h=r[1],v=r[2],y=r[3],b=r[4];for(d=0;d<80;d++){var m=Math.floor(d/20),g=o(p,5)+n(m,h,v,y)+b+t[m]+f[d]>>>0;b=y,y=v,v=o(h,30)>>>0,h=p,p=g}r[0]=r[0]+p>>>0,r[1]=r[1]+h>>>0,r[2]=r[2]+v>>>0,r[3]=r[3]+y>>>0,r[4]=r[4]+b>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(5);t.addScriptToLocalStorage=function(e){var t=i.getScriptsMap(),r=Date.now(),a=n(n({},e),{dateFirstPublished:r,dateLastPublished:r});return t.set(e.id,a),i.updateLocalStorage(o.LocalStorageKeys.recordedScriptsKey,t),a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIsIEBrowser=function(){return/MSIE|Trident/.test(window.navigator.userAgent)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n){var o=e.call(this,r)||this;return o.errorCode=n,Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t}(Error);t.MakerStorageError=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadObjectEntriesPolyfill=function(){Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=Object.keys(e).map((function(t){return e[t]})),n=t.length,o=new Array(n);n--;)o[n]=[t[n],r[n]];return o})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xmlSerializeToString=function(e){return(new XMLSerializer).serializeToString(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.getScriptsFromLocalStorage=function(){var e=[];return n.getScriptsMap().forEach((function(t){return e.push({id:t.id,name:t.name,dateFirstPublished:t.dateFirstPublished,dateLastPublished:t.dateLastPublished,creatorId:t.creatorId})})),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(8),i=r(1);t.getSharedScriptFromLocalStorage=function(e){var t=n.getSharedScriptsMap(),r=null;if(t.forEach((function(t){t.shareId===e&&(r=t)})),r)return r;throw new o.MakerStorageError("Shared script does not exist!",i.StorageErrorCode.ItemNotFound)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(5);t.removeScriptFromLocalStorage=function(e){var t=o.getScriptsMap();t.has(e)&&t.delete(e)&&o.updateLocalStorage(n.LocalStorageKeys.recordedScriptsKey,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(19),a=r(5);function s(e){return"shareId-"+e}t.shareScriptToLocalStorage=function(e){var t=a.getSharedScriptsMap(),r=t.get(e);if(r)return r.shareId||"";var c=s(e),u=i.getScriptFromLocalStorage(e),l=n(n({},u),{shareId:c});return t.set(e,l),a.updateLocalStorage(o.LocalStorageKeys.sharedScriptsKey,t),c},t.generateTestShareId=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),o=r(5);t.unshareScriptFromLocalStorage=function(e){var t=o.getSharedScriptsMap();t.has(e)&&t.delete(e)&&o.updateLocalStorage(n.LocalStorageKeys.sharedScriptsKey,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),i=r(5),a=r(8),s=r(1);t.updateScriptOnLocalStorage=function(e,t){var r=i.getScriptsMap();if(!r.has(e)||!r.get(e))throw new a.MakerStorageError("Script does not exist!",s.StorageErrorCode.ItemNotFound);var c=r.get(e),u=n(n(n({},c),t),{dateLastPublished:Date.now()});return r.set(e,u),i.updateLocalStorage(o.LocalStorageKeys.recordedScriptsKey,r),u}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(18),a=r(2),s=r(4),c=r(0);t.getSharedScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return c.inDevMode()?[4,a.pause(c.getDelay())]:[3,2];case 1:return r.sent(),[2,s.getSharedScriptFromLocalStorage(e)];case 2:return[2,i.getScriptInternal(c.buildStorageUrl()+"/shared/"+e,t,!1)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(20),a=r(0);t.getSharedScripts=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,i.getScriptsInternal(a.buildStorageUrl()+"/shared",e,!1)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(4),s=r(0),c=r(3);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,c.makeDeleteRequest(e,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})]}))}))}t.removeScriptInternal=u,t.removeScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,i.pause(s.getDelay())]:[3,2];case 1:return r.sent(),[2,a.removeScriptFromLocalStorage(e)];case 2:return[2,u(s.buildStorageUrl()+"/"+e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(63),a=r(21),s=r(64);t.saveScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){if(!a.isScriptNameValid(e.name))throw new Error("Script name is invalid.");if(!a.isScriptDescriptionValid(e.description))throw new Error("Script description is invalid.");return[2,e.dateFirstPublished?s.updateScript(e,t):i.publishScript(e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),a=r(2),s=r(4),c=r(0),u=r(3);function l(e,t,r){return n(this,void 0,void 0,(function(){var n,a,s;return o(this,(function(o){switch(o.label){case 0:return[4,u.makePostRequest(e,t,c.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":c.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return a=o.sent(),s=n.headers.get("Version"),[2,i.convertResponseJson(a,s)]}}))}))}t.publishScriptInternal=l,t.publishScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return c.inDevMode()?[4,a.pause(c.getDelay())]:[3,2];case 1:return r.sent(),[2,s.addScriptToLocalStorage(e)];case 2:return[2,l(c.buildStorageUrl(),e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var a=r(7),s=r(2),c=r(4),u=r(0),l=r(3);function f(e,t,r){return n(this,void 0,void 0,(function(){var n,i,s;return o(this,(function(o){switch(o.label){case 0:return[4,l.makePutRequest(e,t,u.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":u.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return i=o.sent(),s=n.headers.get("Version"),[2,a.convertResponseJson(i,s)]}}))}))}t.updateScriptInternal=f,t.updateScript=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return r=e.id,e.dateFirstPublished,e.dateLastPublished,n=i(e,["id","dateFirstPublished","dateLastPublished"]),u.inDevMode()?[4,s.pause(u.getDelay())]:[3,2];case 1:return o.sent(),[2,c.updateScriptOnLocalStorage(r,n)];case 2:return[2,f(u.buildStorageUrl()+"/"+r,n,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(4),s=r(0),c=r(3);t.shareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,i.pause(s.getDelay())]:[3,2];case 1:return r.sent(),[2,a.shareScriptToLocalStorage(e)];case 2:return[4,c.makePutRequest(s.buildStorageUrl()+"/"+e+"/share",!0,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})];case 3:return[4,r.sent().text()];case 4:return[2,r.sent()]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),a=r(4),s=r(0),c=r(3);t.unshareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,i.pause(s.getDelay())]:[3,2];case 1:return r.sent(),a.unshareScriptFromLocalStorage(e),[2];case 2:return[2,c.makePutRequest(s.buildStorageUrl()+"/"+e+"/share",!1,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})]}}))}))}}]);